(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return Pp});var r=n("ofXK"),i=n("fXoL"),o=n("0IaG"),s=n("tyNb"),a=n("/t3+"),u=n("bTqV"),c=n("NFeN"),h=n("STbY"),l=n("XhcP"),f=n("MutI"),d=n("FKr1");function p(t,e){if(1&t&&(i.Vb(0,"mat-list-item",24),i.Vb(1,"mat-icon",25),i.Ac(2),i.Ub(),i.Vb(3,"h3",26),i.Ac(4),i.Ub(),i.Ub()),2&t){const t=e.$implicit;i.mc("routerLink",t.url),i.Eb(2),i.Bc(t.icon),i.Eb(2),i.Bc(t.name)}}function g(t,e){if(1&t&&(i.Vb(0,"div"),i.Vb(1,"h3",22),i.Ac(2),i.Ub(),i.zc(3,p,5,3,"mat-list-item",23),i.Ub()),2&t){const t=i.gc().$implicit;i.Eb(2),i.Bc(t.group),i.Eb(1),i.lc("ngForOf",t.children)}}function m(t,e){if(1&t&&(i.Vb(0,"mat-list-item",24),i.Vb(1,"mat-icon",25),i.Ac(2),i.Ub(),i.Vb(3,"h3",26),i.Ac(4),i.Ub(),i.Ub()),2&t){const t=i.gc().$implicit;i.mc("routerLink",t.url),i.Eb(2),i.Bc(t.icon),i.Eb(2),i.Bc(t.name)}}function y(t,e){if(1&t&&(i.Vb(0,"div"),i.zc(1,g,4,2,"div",20),i.zc(2,m,5,3,"mat-list-item",21),i.Ub()),2&t){const t=e.$implicit;i.Eb(1),i.lc("ngIf",null!=t.children),i.Eb(1),i.lc("ngIf",null==t.children)}}let b=(()=>{class t{constructor(t,e){this.dialog=t,this.router=e,this.mode="side",this.menu=[{name:"Home",icon:"home",url:"/admin/dashboard"},{group:"Menus",children:[{name:"Costumers",icon:"perm_identity",url:"/admin/product"},{name:"HairCare Product",icon:"shopping_bag",url:"/admin/haircare"},{name:"Trolly",icon:"add_shopping_cart",url:"/admin/keranjang"},{name:"Review",icon:"question_answer",url:"/admin/feedback"}]},{group:"Others",children:[{name:"Logout",icon:"power_settings_new",url:"/public/thanks"}]}]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.b),i.Pb(s.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-admin"]],decls:53,vars:11,consts:[[1,"view","intro-2","rgba-gradient"],[1,"full-bg-img"],[1,"container","flex-center"],[1,"row","flex-center","pt-5","mt-3"],[1,"col-md-6","text-center","text-md-left","margins"],[1,"white-text"],["color","primary",1,"example-header"],["mat-icon-button","",3,"click"],[1,"uk-width-expand"],["mat-button","",3,"matMenuTriggerFor"],["appaccount","matMenu"],["mat-menu-item",""],["mat-menu-item","","routerLink","/admin/feedback"],["appmenu","matMenu"],["mat-menu-item","","routerLink","/public/thanks"],[1,"example-container"],["mode","side","opened","",1,"sidenav-left",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],["sidenav",""],[4,"ngFor","ngForOf"],["mode","side",1,"example-container",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],[4,"ngIf"],[3,"routerLink",4,"ngIf"],["matSubheader",""],[3,"routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],["matListIcon",""],["matLine",""]],template:function(t,e){if(1&t){const t=i.Wb();i.Vb(0,"section",0),i.Vb(1,"div",1),i.Vb(2,"div",2),i.Vb(3,"div",3),i.Vb(4,"div",4),i.Qb(5,"div",5),i.Ub(),i.Tb(6),i.Vb(7,"mat-toolbar",6),i.Vb(8,"button",7),i.cc("click",function(){return i.tc(t),i.rc(47).toggle()}),i.Vb(9,"mat-icon"),i.Ac(10,"menu"),i.Ub(),i.Ub(),i.Vb(11,"span"),i.Ac(12,"CUKUR YUK"),i.Ub(),i.Qb(13,"div",8),i.Vb(14,"mat-icon"),i.Ac(15,"account_circle"),i.Ub(),i.Vb(16,"button",9),i.Ac(17,"Admin"),i.Ub(),i.Vb(18,"mat-menu",null,10),i.Vb(20,"button",11),i.Vb(21,"mat-icon"),i.Ac(22,"manage_accounts"),i.Ub(),i.Ac(23,"My Account"),i.Ub(),i.Vb(24,"button",12),i.Vb(25,"mat-icon"),i.Ac(26,"question_answer"),i.Ub(),i.Ac(27,"Review"),i.Ub(),i.Ub(),i.Vb(28,"button",9),i.Vb(29,"mat-icon"),i.Ac(30,"more_horiz"),i.Ub(),i.Ub(),i.Vb(31,"mat-menu",null,13),i.Vb(33,"button",11),i.Vb(34,"mat-icon"),i.Ac(35,"restore"),i.Ub(),i.Ac(36," Riwayat"),i.Ub(),i.Vb(37,"button",11),i.Vb(38,"mat-icon"),i.Ac(39,"settings"),i.Ub(),i.Ac(40,"settings"),i.Ub(),i.Vb(41,"button",14),i.Vb(42,"mat-icon"),i.Ac(43,"power_settings_new"),i.Ub(),i.Ac(44,"Logout"),i.Ub(),i.Ub(),i.Ub(),i.Vb(45,"mat-sidenav-container",15),i.Vb(46,"mat-sidenav",16,17),i.Vb(48,"mat-nav-list"),i.zc(49,y,3,2,"div",18),i.Ub(),i.Ub(),i.Qb(50,"mat-sidenav",19,17),i.Qb(52,"router-outlet"),i.Ub(),i.Sb(),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=i.rc(19),n=i.rc(32);i.Eb(16),i.lc("matMenuTriggerFor",t),i.Eb(12),i.lc("matMenuTriggerFor",n),i.Eb(18),i.lc("position","start")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0),i.Eb(3),i.lc("ngForOf",e.menu),i.Eb(1),i.lc("position","end")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0)}},directives:[a.a,u.a,c.a,h.d,h.a,h.b,s.b,l.b,l.a,f.e,r.j,s.d,r.k,f.d,f.b,f.a,d.j],styles:["",'.intro-header[_ngcontent-%COMP%] {\n    height: unset !important;\n  }\n\n  .intro-2[_ngcontent-%COMP%] {\n    background: url("https://images.pexels.com/photos/1813272/pexels-photo-1813272.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940")no-repeat center center;\n    background-size: cover;\n  }\n\n  .view[_ngcontent-%COMP%] {\n    height: 100vh !important;\n  }\n\n  .btn[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%] {\n    margin-left: 3px;\n  }\n\n  .top-nav-collapse[_ngcontent-%COMP%] {\n    background-color: #424f95 !important;\n  }\n\n  .navbar[_ngcontent-%COMP%]:not(.top-nav-collapse) {\n    background: transparent !important;\n  }\n\n  @media (max-width: 768px) {\n    .navbar[_ngcontent-%COMP%]:not(.top-nav-collapse) {\n      background: #424f95 !important;\n    }\n  }\n\n  h6[_ngcontent-%COMP%] {\n    line-height: 1.7;\n  }\n\n  \n\n  @media (max-width: 450px) {\n    .margins[_ngcontent-%COMP%] {\n      margin-right: 1rem;\n      margin-left: 1rem;\n    }\n  }\n\n  @media (max-width: 740px) {\n\n    .full-height[_ngcontent-%COMP%], .full-height[_ngcontent-%COMP%]   body[_ngcontent-%COMP%], .full-height[_ngcontent-%COMP%]   header[_ngcontent-%COMP%], .full-height[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   .view[_ngcontent-%COMP%] {\n      height: 1020px;\n    }\n  }']}),t})();var v=n("Wp6s");let w=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-dashboard"]],decls:34,vars:0,consts:[["name","viewport","content","width=device-width, initial-scale=1"],[2,"font-size","24px","font-weight","semi-bold","color","rgb(73, 53, 53)"],[1,"row"],[1,"column",2,"background-color","#ffffff"],[2,"background-color","#e9dbdb"],[2,"font-size","20px","font-weight","bold","color","rgb(0, 0, 0)"],[1,"uk-flex"],[1,"uk-width-expand"],["mat-raised-button","","color","accent","routerLink","/admin/product"],["mat-raised-button","","color","accent","routerLink","/admin/haircare"]],template:function(t,e){1&t&&(i.Vb(0,"html"),i.Vb(1,"head"),i.Qb(2,"meta",0),i.Ub(),i.Vb(3,"body"),i.Vb(4,"mat-card-header"),i.Vb(5,"mat-card-title",1),i.Ac(6," DASHBOARD"),i.Ub(),i.Ub(),i.Vb(7,"div",2),i.Vb(8,"td"),i.Vb(9,"div",3),i.Vb(10,"mat-card",4),i.Vb(11,"mat-card-header"),i.Vb(12,"mat-card-title",5),i.Ac(13,"CUKUR YUK"),i.Ub(),i.Vb(14,"mat-card-title"),i.Ac(15,"Senin, 10 Desember 2021"),i.Ub(),i.Ub(),i.Vb(16,"mat-card-content"),i.Vb(17,"div",6),i.Qb(18,"span",7),i.Vb(19,"button",8),i.Ac(20,"View Costumers"),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(21,"td"),i.Vb(22,"div",3),i.Vb(23,"mat-card",4),i.Vb(24,"mat-card-header"),i.Vb(25,"mat-card-title",5),i.Ac(26,"Promo Hair Care"),i.Ub(),i.Vb(27,"mat-card-title"),i.Ac(28,"Diskon Up To 30%"),i.Ub(),i.Ub(),i.Vb(29,"mat-card-content"),i.Vb(30,"div",6),i.Qb(31,"span",7),i.Vb(32,"button",9),i.Ac(33,"View Hair Care"),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Ub())},directives:[v.c,v.e,v.a,v.b,u.a,s.b],styles:["","*[_ngcontent-%COMP%] {\n            box-sizing: border-box;\n        }\n\n        \n        .column[_ngcontent-%COMP%] {\n            position:center;\n            width: 100%;\n            padding: 10px;\n            height: 230px;\n            width: 600px\n            \n        }"]}),t})();var E=n("w55g"),I=n("D0XW"),T=n("HDdC"),_=n("Cfvw"),O=n("LRne"),A=n("JX91"),S=n("Zy1z"),D=n("lJxs"),k=n("Kqap"),N=n("/uUt"),C=n("pLZG"),j=n("pxpQ"),x=n("spgP"),U=n("Jgta"),V=n("zIRd"),R=n("mrSG"),M=n("qOnz"),P=n("q/0M"),L=function(t,e){return(L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function F(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var q,B="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},K=K||{},G=B||self;function Q(){}function z(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function H(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var W="closure_uid_"+(1e9*Math.random()>>>0),Y=0;function $(t,e,n){return t.call.apply(t.bind,arguments)}function X(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function J(t,e,n){return(J=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?$:X).apply(null,arguments)}function Z(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function tt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function et(){this.s=this.s,this.o=this.o}var nt={};et.prototype.s=!1,et.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,W)&&t[W]||(t[W]=++Y)}(this);delete nt[t]}},et.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var rt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},it=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function ot(t){return Array.prototype.concat.apply([],arguments)}function st(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function at(t){return/^[\s\xa0]*$/.test(t)}var ut,ct=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ht(t,e){return-1!=t.indexOf(e)}function lt(t,e){return t<e?-1:t>e?1:0}t:{var ft=G.navigator;if(ft){var dt=ft.userAgent;if(dt){ut=dt;break t}}ut=""}function pt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function gt(t){var e={};for(var n in t)e[n]=t[n];return e}var mt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<mt.length;o++)n=mt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function bt(t){return bt[" "](t),t}bt[" "]=Q;var vt,wt,Et=ht(ut,"Opera"),It=ht(ut,"Trident")||ht(ut,"MSIE"),Tt=ht(ut,"Edge"),_t=Tt||It,Ot=ht(ut,"Gecko")&&!(ht(ut.toLowerCase(),"webkit")&&!ht(ut,"Edge"))&&!(ht(ut,"Trident")||ht(ut,"MSIE"))&&!ht(ut,"Edge"),At=ht(ut.toLowerCase(),"webkit")&&!ht(ut,"Edge");function St(){var t=G.document;return t?t.documentMode:void 0}t:{var Dt="",kt=(wt=ut,Ot?/rv:([^\);]+)(\)|;)/.exec(wt):Tt?/Edge\/([\d\.]+)/.exec(wt):It?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(wt):At?/WebKit\/(\S+)/.exec(wt):Et?/(?:Version)[ \/]?(\S+)/.exec(wt):void 0);if(kt&&(Dt=kt?kt[1]:""),It){var Nt=St();if(null!=Nt&&Nt>parseFloat(Dt)){vt=String(Nt);break t}}vt=Dt}var Ct={};var jt=G.document&&It&&(St()||parseInt(vt,10))||void 0,xt=function(){if(!G.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{G.addEventListener("test",Q,e),G.removeEventListener("test",Q,e)}catch(n){}return t}();function Ut(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Vt(t,e){if(Ut.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Ot){t:{try{bt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Rt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Vt.Z.h.call(this)}}Ut.prototype.h=function(){this.defaultPrevented=!0},tt(Vt,Ut);var Rt={2:"touch",3:"pen",4:"mouse"};Vt.prototype.h=function(){Vt.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Mt="closure_listenable_"+(1e6*Math.random()|0),Pt=0;function Lt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Pt,this.ca=this.fa=!1}function Ft(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function qt(t){this.src=t,this.g={},this.h=0}function Bt(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=rt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Ft(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}qt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=Kt(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new Lt(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var Gt="closure_lm_"+(1e6*Math.random()|0),Qt={};function zt(t,e,n,r,i){if(r&&r.once)return Wt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)zt(t,e[o],n,r,i);return null}return n=ee(n),t&&t[Mt]?t.N(e,n,H(r)?!!r.capture:!!r,i):Ht(t,e,n,!1,r,i)}function Ht(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=H(i)?!!i.capture:!!i,a=Zt(t);if(a||(t[Gt]=a=new qt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Jt;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)xt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Xt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Wt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Wt(t,e[o],n,r,i);return null}return n=ee(n),t&&t[Mt]?t.O(e,n,H(r)?!!r.capture:!!r,i):Ht(t,e,n,!0,r,i)}function Yt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Yt(t,e[o],n,r,i);else r=H(r)?!!r.capture:!!r,n=ee(n),t&&t[Mt]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Kt(o=t.g[e],n,r,i))&&(Ft(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--))):t&&(t=Zt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Kt(e,n,r,i)),(n=-1<t?e[t]:null)&&$t(n))}function $t(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Mt])Bt(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Xt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Zt(e))?(Bt(n,t),0==n.h&&(n.src=null,e[Gt]=null)):Ft(t)}}}function Xt(t){return t in Qt?Qt[t]:Qt[t]="on"+t}function Jt(t,e){if(t.ca)t=!0;else{e=new Vt(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&$t(t),t=n.call(r,e)}return t}function Zt(t){return(t=t[Gt])instanceof qt?t:null}var te="__closure_events_fn_"+(1e9*Math.random()>>>0);function ee(t){return"function"==typeof t?t:(t[te]||(t[te]=function(e){return t.handleEvent(e)}),t[te])}function ne(){et.call(this),this.i=new qt(this),this.P=this,this.I=null}function re(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new Ut(e,t);else if(e instanceof Ut)e.target=e.target||t;else{var i=e;yt(e=new Ut(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=ie(s,r,!0,e)&&i}if(i=ie(s=e.g=t,r,!0,e)&&i,i=ie(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=ie(s=e.g=n[o],r,!1,e)&&i}function ie(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Bt(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}tt(ne,et),ne.prototype[Mt]=!0,ne.prototype.removeEventListener=function(t,e,n,r){Yt(this,t,e,n,r)},ne.prototype.M=function(){if(ne.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Ft(n[r]);delete e.g[t],e.h--}}this.I=null},ne.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},ne.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var oe=G.JSON.stringify;function se(){var t=pe,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var ae,ue=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=ce.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),ce=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,this.g=(t=this.g).next,t.next=null):t=this.i(),t},t}())(function(){return new he},function(t){return t.reset()}),he=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function le(t){G.setTimeout(function(){throw t},0)}function fe(t,e){ae||function(){var t=G.Promise.resolve(void 0);ae=function(){t.then(ge)}}(),de||(ae(),de=!0),pe.add(t,e)}var de=!1,pe=new ue;function ge(){for(var t;t=se();){try{t.h.call(t.g)}catch(n){le(n)}var e=ce;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}de=!1}function me(t,e){ne.call(this),this.h=t||1,this.g=e||G,this.j=J(this.kb,this),this.l=Date.now()}function ye(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function be(t,e,n){if("function"==typeof t)n&&(t=J(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=J(t.handleEvent,t)}return 2147483647<Number(e)?-1:G.setTimeout(t,e||0)}function ve(t){t.g=be(function(){t.g=null,t.i&&(t.i=!1,ve(t))},t.j);var e=t.h;t.h=null,t.m.apply(null,e)}tt(me,ne),(q=me.prototype).da=!1,q.S=null,q.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),re(this,"tick"),this.da&&(ye(this),this.start()))}},q.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},q.M=function(){me.Z.M.call(this),ye(this),delete this.g};var we=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}L(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:ve(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(G.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(et);function Ee(t){et.call(this),this.h=t,this.g={}}tt(Ee,et);var Ie=[];function Te(t,e,n,r){Array.isArray(n)||(n&&(Ie[0]=n.toString()),n=Ie);for(var i=0;i<n.length;i++){var o=zt(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function _e(t){pt(t.g,function(t,e){this.g.hasOwnProperty(e)&&$t(t)},t),t.g={}}function Oe(){this.g=!0}function Ae(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return oe(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}Ee.prototype.M=function(){Ee.Z.M.call(this),_e(this)},Ee.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Oe.prototype.Aa=function(){this.g=!1},Oe.prototype.info=function(){};var Se={},De=null;function ke(){return De=De||new ne}function Ne(t){Ut.call(this,Se.Ma,t)}function Ce(t){var e=ke();re(e,new Ne(e,t))}function je(t,e){Ut.call(this,Se.STAT_EVENT,t),this.stat=e}function xe(t){var e=ke();re(e,new je(e,t))}function Ue(t,e){Ut.call(this,Se.Na,t),this.size=e}function Ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return G.setTimeout(function(){t()},e)}Se.Ma="serverreachability",tt(Ne,Ut),Se.STAT_EVENT="statevent",tt(je,Ut),Se.Na="timingevent",tt(Ue,Ut);var Re={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Me={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Pe(){}function Le(){}Pe.prototype.h=null;var Fe,qe={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Be(){Ut.call(this,"d")}function Ke(){Ut.call(this,"c")}function Ge(){}function Qe(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Ee(this),this.P=He,this.W=new me(t=_t?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ze}function ze(){this.i=null,this.g="",this.h=!1}tt(Be,Ut),tt(Ke,Ut),tt(Ge,Pe),Ge.prototype.g=function(){return new XMLHttpRequest},Ge.prototype.i=function(){return{}},Fe=new Ge;var He=45e3,We={},Ye={};function $e(t,e,n){t.K=1,t.v=wn(pn(e)),t.s=n,t.U=!0,Xe(t,null)}function Xe(t,e){t.F=Date.now(),en(t),t.A=pn(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),xn(n.h,"t",r),t.C=0,n=t.l.H,t.h=new ze,t.g=Ur(t.l,n?e:null,!t.s),0<t.O&&(t.L=new we(J(t.Ia,t,t.g),t.O)),Te(t.V,t.g,"readystatechange",t.gb),e=t.H?gt(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Ce(1),function(t,e,n,r,i,o){t.info(function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.j,t.u,t.A,t.m,t.X,t.s)}function Je(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function Ze(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=tn(t,n))==Ye){4==e&&(t.o=4,xe(14),i=!1),Ae(t.j,t.m,null,"[Incomplete Response]");break}if(r==We){t.o=4,xe(15),Ae(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Ae(t.j,t.m,r,null),an(t,r)}Je(t)&&r!=Ye&&r!=We&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,xe(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ar(e),e.L=!0,xe(11))):(Ae(t.j,t.m,n,"[Invalid Chunked Response]"),sn(t),on(t))}function tn(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Ye:(n=Number(e.substring(n,r)),isNaN(n)?We:(r+=1)+n>e.length?Ye:(e=e.substr(r,n),t.C=r+n,e))}function en(t){t.Y=Date.now()+t.P,nn(t,t.P)}function nn(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Ve(J(t.eb,t),e)}function rn(t){t.B&&(G.clearTimeout(t.B),t.B=null)}function on(t){0==t.l.G||t.I||kr(t.l,t)}function sn(t){rn(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,ye(t.W),_e(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function an(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Fn(n.i,t)))if(n.I=t.N,!t.J&&Fn(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Dr(n),yr(n)}Or(n),xe(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Ve(J(n.ab,n),6e3));if(1>=Ln(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else Cr(n,11)}else if((t.J||n.g==t)&&Dr(n),!at(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(ht(h,"spdy")||ht(h,"quic")||ht(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(qn(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,vn(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=xr(r,r.H?r.la:null,r.W),d.J){Bn(r.i,d);var p=d,g=r.K;g&&p.setTimeout(g),p.B&&(rn(p),en(p)),r.g=d}else _r(r);0<n.l.length&&wr(n)}else"stop"!=o[0]&&"close"!=o[0]||Cr(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?Cr(n,7):mr(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}Ce(4)}catch(o){}}function un(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(z(t)||"string"==typeof t)it(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(z(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(z(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function cn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof cn)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function hn(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ln(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)ln(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function ln(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(q=Qe.prototype).setTimeout=function(t){this.P=t},q.gb=function(t){t=t.target;var e=this.L;e&&3==lr(t)?e.l():this.Ia(t)},q.Ia=function(t){try{if(t==this.g)t:{var e=lr(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||_t||this.g&&(this.h.h||this.g.ga()||fr(this.g)))){this.I||4!=e||7==n||Ce(8==n||0>=r?3:2),rn(this);var i=this.g.ba();this.N=i;e:if(Je(this)){var o=fr(this.g);t="";var s=o.length,a=4==lr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){sn(this),on(this);var u="";break e}this.h.i=new G.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!at(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,xe(12),sn(this),on(this);break t}Ae(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,an(this,i)}this.U?(Ze(this,e,u),_t&&this.i&&3==e&&(Te(this.V,this.W,"tick",this.fb),this.W.start())):(Ae(this.j,this.m,u,null),an(this,u)),4==e&&sn(this),this.i&&!this.I&&(4==e?kr(this.l,this):(this.i=!1,en(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,xe(12)):(this.o=0,xe(13)),sn(this),on(this)}}}catch(e){}},q.fb=function(){if(this.g){var t=lr(this.g),e=this.g.ga();this.C<e.length&&(rn(this),Ze(this,t,e),this.i&&4!=t&&en(this))}},q.cancel=function(){this.I=!0,sn(this)},q.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Ce(3),xe(17)),sn(this),this.o=2,on(this)):nn(this,this.Y-t)},(q=cn.prototype).R=function(){hn(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},q.T=function(){return hn(this),this.g.concat()},q.get=function(t,e){return ln(this.h,t)?this.h[t]:e},q.set=function(t,e){ln(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},q.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var fn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function dn(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof dn){this.g=void 0!==e?e:t.g,gn(this,t.j),this.s=t.s,mn(this,t.i),yn(this,t.m),this.l=t.l,e=t.h;var n=new kn;n.i=e.i,e.g&&(n.g=new cn(e.g),n.h=e.h),bn(this,n),this.o=t.o}else t&&(n=String(t).match(fn))?(this.g=!!e,gn(this,n[1]||"",!0),this.s=En(n[2]||""),mn(this,n[3]||"",!0),yn(this,n[4]),this.l=En(n[5]||"",!0),bn(this,n[6]||"",!0),this.o=En(n[7]||"")):(this.g=!!e,this.h=new kn(null,this.g))}function pn(t){return new dn(t)}function gn(t,e,n){t.j=n?En(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function mn(t,e,n){t.i=n?En(e,!0):e}function yn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function bn(t,e,n){e instanceof kn?(t.h=e,function(t,e){e&&!t.j&&(Nn(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Cn(this,e),xn(this,n,t))},t)),t.j=e}(t.h,t.g)):(n||(e=In(e,Sn)),t.h=new kn(e,t.g))}function vn(t,e,n){t.h.set(e,n)}function wn(t){return vn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function En(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function In(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}dn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(In(e,_n,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(In(e,_n,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(In(n,"/"==n.charAt(0)?An:On,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",In(n,Dn)),t.join("")};var _n=/[#\/\?@]/g,On=/[#\?:]/g,An=/[#\?]/g,Sn=/[#\?@]/g,Dn=/#/g;function kn(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Nn(t){t.g||(t.g=new cn,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Cn(t,e){Nn(t),e=Un(t,e),ln(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,ln((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&hn(t)))}function jn(t,e){return Nn(t),e=Un(t,e),ln(t.g.h,e)}function xn(t,e,n){Cn(t,e),0<n.length&&(t.i=null,t.g.set(Un(t,e),st(n)),t.h+=n.length)}function Un(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(q=kn.prototype).add=function(t,e){Nn(this),this.i=null,t=Un(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},q.forEach=function(t,e){Nn(this),this.g.forEach(function(n,r){it(n,function(n){t.call(e,n,r,this)},this)},this)},q.T=function(){Nn(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},q.R=function(t){Nn(this);var e=[];if("string"==typeof t)jn(this,t)&&(e=ot(e,this.g.get(Un(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=ot(e,t[n])}return e},q.set=function(t,e){return Nn(this),this.i=null,jn(this,t=Un(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},q.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},q.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Vn=function(){return function(t,e){this.h=t,this.g=e}}();function Rn(t){this.l=t||Mn,t=G.PerformanceNavigationTiming?0<(t=G.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(G.g&&G.g.Ea&&G.g.Ea()&&G.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Mn=10;function Pn(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Ln(t){return t.h?1:t.g?t.g.size:0}function Fn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function qn(t,e){t.g?t.g.add(e):t.h=e}function Bn(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Kn(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=F(t.g.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.D)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return st(t.i)}function Gn(){}function Qn(){this.g=new Gn}function zn(t,e,n){var r=n||"";try{un(t,function(t,n){var i=t;H(t)&&(i=oe(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(ep){throw e.push(r+"type="+encodeURIComponent("_badmap")),ep}}function Hn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}function Wn(t){this.l=t.$b||null,this.j=t.ib||!1}function Yn(t,e){ne.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=$n,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Rn.prototype.cancel=function(){var t,e;if(this.i=Kn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=F(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Gn.prototype.stringify=function(t){return G.JSON.stringify(t,void 0)},Gn.prototype.parse=function(t){return G.JSON.parse(t,void 0)},tt(Wn,Pe),Wn.prototype.g=function(){return new Yn(this.l,this.j)},Wn.prototype.i=function(t){return function(){return t}}({}),tt(Yn,ne);var $n=0;function Xn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Jn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Zn(t)}function Zn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(q=Yn.prototype).open=function(t,e){if(this.readyState!=$n)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Zn(this)},q.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||G).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},q.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Jn(this)),this.readyState=$n},q.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Zn(this)),this.g&&(this.readyState=3,Zn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==G.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Xn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},q.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Jn(this):Zn(this),3==this.readyState&&Xn(this)}},q.Ua=function(t){this.g&&(this.response=this.responseText=t,Jn(this))},q.Ta=function(t){this.g&&(this.response=t,Jn(this))},q.ha=function(){this.g&&Jn(this)},q.setRequestHeader=function(t,e){this.v.append(t,e)},q.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},q.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Yn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var tr=G.JSON.parse;function er(t){ne.call(this),this.headers=new cn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=nr,this.K=this.L=!1}tt(er,ne);var nr="",rr=/^https?$/i,ir=["POST","PUT"];function or(t){return"content-type"==t.toLowerCase()}function sr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,ar(t),cr(t)}function ar(t){t.D||(t.D=!0,re(t,"complete"),re(t,"error"))}function ur(t){if(t.h&&void 0!==K&&(!t.C[1]||4!=lr(t)||2!=t.ba()))if(t.v&&4==lr(t))be(t.Fa,0,t);else if(re(t,"readystatechange"),4==lr(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(fn)[1]||null;if(!o&&G.self&&G.self.location){var s=G.self.location.protocol;o=s.substr(0,s.length-1)}i=!rr.test(o?o.toLowerCase():"")}e=i}if(e)re(t,"complete"),re(t,"success");else{t.m=6;try{var a=2<lr(t)?t.g.statusText:""}catch(u){a=""}t.j=a+" ["+t.ba()+"]",ar(t)}}finally{cr(t)}}}function cr(t,e){if(t.g){hr(t);var n=t.g,r=t.C[0]?Q:null;t.g=null,t.C=null,e||re(t,"ready");try{n.onreadystatechange=r}catch(ep){}}}function hr(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(G.clearTimeout(t.A),t.A=null)}function lr(t){return t.g?t.g.readyState:0}function fr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case nr:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function dr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return pt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):vn(t,e,n))}function pr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function gr(t){this.za=0,this.l=[],this.h=new Oe,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=pr("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=pr("baseRetryDelayMs",5e3,t),this.$a=pr("retryDelaySeedMs",1e4,t),this.Ya=pr("forwardChannelMaxRetries",2,t),this.ra=pr("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Rn(t&&t.concurrentRequestLimit),this.Ca=new Qn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function mr(t){if(br(t),3==t.G){var e=t.V++,n=pn(t.F);vn(n,"SID",t.J),vn(n,"RID",e),vn(n,"TYPE","terminate"),Ir(t,n),(e=new Qe(t,t.h,e,void 0)).K=2,e.v=wn(pn(n)),n=!1,G.navigator&&G.navigator.sendBeacon&&(n=G.navigator.sendBeacon(e.v.toString(),"")),!n&&G.Image&&((new Image).src=e.v,n=!0),n||(e.g=Ur(e.l,null),e.g.ea(e.v)),e.F=Date.now(),en(e)}jr(t)}function yr(t){t.g&&(Ar(t),t.g.cancel(),t.g=null)}function br(t){yr(t),t.u&&(G.clearTimeout(t.u),t.u=null),Dr(t),t.i.cancel(),t.m&&("number"==typeof t.m&&G.clearTimeout(t.m),t.m=null)}function vr(t,e){t.l.push(new Vn(t.Za++,e)),3==t.G&&wr(t)}function wr(t){Pn(t.i)||t.m||(t.m=!0,fe(t.Ha,t),t.C=0)}function Er(t,e){var n;n=e?e.m:t.V++;var r=pn(t.F);vn(r,"SID",t.J),vn(r,"RID",n),vn(r,"AID",t.U),Ir(t,r),t.o&&t.s&&dr(r,t.o,t.s),n=new Qe(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),qn(t.i,n),$e(n,r,e)}function Ir(t,e){t.j&&un({},function(t,n){vn(e,n,t)})}function Tr(t,e,n){n=Math.min(t.l.length,n);var r=t.j?J(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].h)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{zn(h,s,"req"+c+"_")}catch(pi){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function _r(t){t.g||t.u||(t.Y=1,fe(t.Ga,t),t.A=0)}function Or(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=Ve(J(t.Ga,t),Nr(t,t.A)),t.A++,0))}function Ar(t){null!=t.B&&(G.clearTimeout(t.B),t.B=null)}function Sr(t){t.g=new Qe(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=pn(t.oa);vn(e,"RID","rpc"),vn(e,"SID",t.J),vn(e,"CI",t.N?"0":"1"),vn(e,"AID",t.U),Ir(t,e),vn(e,"TYPE","xmlhttp"),t.o&&t.s&&dr(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=wn(pn(e)),n.s=null,n.U=!0,Xe(n,t)}function Dr(t){null!=t.v&&(G.clearTimeout(t.v),t.v=null)}function kr(t,e){var n=null;if(t.g==e){Dr(t),Ar(t),t.g=null;var r=2}else{if(!Fn(t.i,e))return;n=e.D,Bn(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;re(r=ke(),new Ue(r,n,e,i)),wr(t)}else _r(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Ln(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Ve(J(t.Ha,t,e),Nr(t,t.C)),t.C++,0)))}(t,e)||2==r&&Or(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Cr(t,5);break;case 4:Cr(t,10);break;case 3:Cr(t,6);break;default:Cr(t,2)}}function Nr(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Cr(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=J(t.jb,t);n||(n=new dn("//www.google.com/images/cleardot.gif"),G.location&&"http"==G.location.protocol||gn(n,"https"),wn(n)),function(t,e){var n=new Oe;if(G.Image){var r=new Image;r.onload=Z(Hn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Z(Hn,n,r,"TestLoadImage: error",!1,e),r.onabort=Z(Hn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Z(Hn,n,r,"TestLoadImage: timeout",!1,e),G.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else xe(2);t.G=0,t.j&&t.j.va(e),jr(t),br(t)}function jr(t){t.G=0,t.I=-1,t.j&&(0==Kn(t.i).length&&0==t.l.length||(t.i.i.length=0,st(t.l),t.l.length=0),t.j.ua())}function xr(t,e,n){var r=function(t){return t instanceof dn?pn(t):new dn(t,void 0)}(n);if(""!=r.i)e&&mn(r,e+"."+r.i),yn(r,r.m);else{var i=G.location;r=function(t,e,n,r){var i=new dn(null,void 0);return t&&gn(i,t),e&&mn(i,e),n&&yn(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&pt(t.aa,function(t,e){vn(r,e,t)}),n=t.sa,(e=t.D)&&n&&vn(r,e,n),vn(r,"VER",t.ma),Ir(t,r),r}function Ur(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new er(n&&t.Ba&&!t.qa?new Wn({ib:!0}):t.qa)).L=t.H,e}function Vr(){}function Rr(){if(It&&!(10<=Number(jt)))throw Error("Environmental error: no available transport.")}function Mr(t,e){ne.call(this),this.g=new gr(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!at(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!at(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Fr(this)}function Pr(t){Be.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Lr(){Ke.call(this),this.status=1}function Fr(t){this.g=t}(q=er.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Fe.g(),this.C=function(t){return t.h||(t.h=t.i())}(this.u?this.u:Fe),this.g.onreadystatechange=J(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void sr(this,o)}t=n||"";var i=new cn(this.headers);r&&un(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=or,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=G.FormData&&t instanceof G.FormData,!(0<=rt(ir,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.g.setRequestHeader(e,t)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{hr(this),0<this.B&&((this.K=function(t){return It&&function(){return t=Ct,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){for(var t=0,e=ct(String(vt)).split("."),n=ct("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=lt(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||lt(0==o[2].length,0==s[2].length)||lt(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}();var t}()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=J(this.pa,this)):this.A=be(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){sr(this,o)}},q.pa=function(){void 0!==K&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,re(this,"timeout"),this.abort(8))},q.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,re(this,"complete"),re(this,"abort"),cr(this))},q.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),cr(this,!0)),er.Z.M.call(this)},q.Fa=function(){this.s||(this.F||this.v||this.l?ur(this):this.cb())},q.cb=function(){ur(this)},q.ba=function(){try{return 2<lr(this)?this.g.status:-1}catch(wt){return-1}},q.ga=function(){try{return this.g?this.g.responseText:""}catch(wt){return""}},q.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),tr(e)}},q.Da=function(){return this.m},q.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(q=gr.prototype).ma=8,q.G=1,q.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},q.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Qe(this,this.h,t,void 0),n=this.s;if(this.P&&(n?yt(n=gt(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=Tr(this,e,r),vn(i=pn(this.F),"RID",t),vn(i,"CVER",22),this.D&&vn(i,"X-HTTP-Session-Id",this.D),Ir(this,i),this.o&&n&&dr(i,this.o,n),qn(this.i,e),this.Ra&&vn(i,"TYPE","init"),this.ja?(vn(i,"$req",r),vn(i,"SID","null"),e.$=!0,$e(e,i,null)):$e(e,i,r),this.G=2}}else 3==this.G&&(t?Er(this,t):0==this.l.length||Pn(this.i)||Er(this))},q.Ga=function(){if(this.u=null,Sr(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Ve(J(this.bb,this),t)}},q.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,xe(10),yr(this),Sr(this))},q.ab=function(){null!=this.v&&(this.v=null,yr(this),Or(this),xe(19))},q.jb=function(t){t?(this.h.info("Successfully pinged google.com"),xe(2)):(this.h.info("Failed to ping google.com"),xe(1))},(q=Vr.prototype).xa=function(){},q.wa=function(){},q.va=function(){},q.ua=function(){},q.Oa=function(){},Rr.prototype.g=function(t,e){return new Mr(t,e)},tt(Mr,ne),Mr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),fe(J(t.hb,t,e))),xe(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=xr(t,null,t.W),wr(t)},Mr.prototype.close=function(){mr(this.g)},Mr.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,vr(this.g,e)}else this.v?((e={}).__data__=oe(t),vr(this.g,e)):vr(this.g,t)},Mr.prototype.M=function(){this.g.j=null,delete this.j,mr(this.g),delete this.g,Mr.Z.M.call(this)},tt(Pr,Be),tt(Lr,Ke),tt(Fr,Vr),Fr.prototype.xa=function(){re(this.g,"a")},Fr.prototype.wa=function(t){re(this.g,new Pr(t))},Fr.prototype.va=function(t){re(this.g,new Lr(t))},Fr.prototype.ua=function(){re(this.g,"b")},Rr.prototype.createWebChannel=Rr.prototype.g,Mr.prototype.send=Mr.prototype.u,Mr.prototype.open=Mr.prototype.m,Mr.prototype.close=Mr.prototype.close,Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,Me.COMPLETE="complete",Le.EventType=qe,qe.OPEN="a",qe.CLOSE="b",qe.ERROR="c",qe.MESSAGE="d",ne.prototype.listen=ne.prototype.N,er.prototype.listenOnce=er.prototype.O,er.prototype.getLastError=er.prototype.La,er.prototype.getLastErrorCode=er.prototype.Da,er.prototype.getStatus=er.prototype.ba,er.prototype.getResponseJson=er.prototype.Qa,er.prototype.getResponseText=er.prototype.ga,er.prototype.send=er.prototype.ea;var qr=Re,Br=Me,Kr=Se,Gr=Wn,Qr=Le,zr=er,Hr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Hr.o=-1;var Wr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(R.c)(e,t),e}(Error),$r=new P.b("@firebase/firestore");function Xr(){return $r.logLevel}function Jr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if($r.logLevel<=P.a.DEBUG){var r=e.map(ei);$r.debug.apply($r,Object(R.f)(["Firestore (8.7.0): "+t],r))}}function Zr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if($r.logLevel<=P.a.ERROR){var r=e.map(ei);$r.error.apply($r,Object(R.f)(["Firestore (8.7.0): "+t],r))}}function ti(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if($r.logLevel<=P.a.WARN){var r=e.map(ei);$r.warn.apply($r,Object(R.f)(["Firestore (8.7.0): "+t],r))}}function ei(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(ep){return t}}function ni(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.7.0) INTERNAL ASSERTION FAILED: "+t;throw Zr(e),new Error(e)}function ri(t,e){t||ni()}function ii(t,e){return t}function oi(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var si=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=oi(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ai(t,e){return t<e?-1:t>e?1:0}function ui(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function ci(t){return t+"\0"}var hi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Yr(Wr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Yr(Wr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(Wr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Yr(Wr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?ai(this.nanoseconds,t.nanoseconds):ai(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),li=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new hi(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function fi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function di(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function pi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var gi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ni(),void 0===n?n=t.length-e:n>t.length-e&&ni(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),mi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(R.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.emptyPath=function(){return new e([])},e}(gi),yi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,bi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(R.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return yi.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Yr(Wr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Yr(Wr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Yr(Wr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(gi),vi=function(){function t(t){this.fields=t,t.sort(bi.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return ui(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),wi=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return ai(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();wi.EMPTY_BYTE_STRING=new wi("");var Ei=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ii(t){if(ri(!!t),"string"==typeof t){var e=0,n=Ei.exec(t);if(ri(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ti(t.seconds),nanos:Ti(t.nanos)}}function Ti(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function _i(t){return"string"==typeof t?wi.fromBase64String(t):wi.fromUint8Array(t)}function Oi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ai(t){var e=t.mapValue.fields.__previous_value__;return Oi(e)?Ai(e):e}function Si(t){var e=Ii(t.mapValue.fields.__local_write_time__.timestampValue);return new hi(e.seconds,e.nanos)}function Di(t){return null==t}function ki(t){return 0===t&&1/t==-1/0}function Ni(t){return"number"==typeof t&&Number.isInteger(t)&&!ki(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ci=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(mi.fromString(e))},t.fromName=function(e){return new t(mi.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===mi.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return mi.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new mi(e.slice()))},t}();function ji(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Oi(t)?4:10:ni()}function xi(t,e){var n=ji(t);if(n!==ji(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Si(t).isEqual(Si(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Ii(t.timestampValue),r=Ii(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return _i(t.bytesValue).isEqual(_i(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ti(t.geoPointValue.latitude)===Ti(e.geoPointValue.latitude)&&Ti(t.geoPointValue.longitude)===Ti(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ti(t.integerValue)===Ti(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ti(t.doubleValue),r=Ti(e.doubleValue);return n===r?ki(n)===ki(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ui(t.arrayValue.values||[],e.arrayValue.values||[],xi);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(fi(n)!==fi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!xi(n[i],r[i])))return!1;return!0}(t,e);default:return ni()}}function Ui(t,e){return void 0!==(t.values||[]).find(function(t){return xi(t,e)})}function Vi(t,e){var n=ji(t),r=ji(e);if(n!==r)return ai(n,r);switch(n){case 0:return 0;case 1:return ai(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Ti(t.integerValue||t.doubleValue),r=Ti(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Ri(t.timestampValue,e.timestampValue);case 4:return Ri(Si(t),Si(e));case 5:return ai(t.stringValue,e.stringValue);case 6:return function(t,e){var n=_i(t),r=_i(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ai(n[i],r[i]);if(0!==o)return o}return ai(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ai(Ti(t.latitude),Ti(e.latitude));return 0!==n?n:ai(Ti(t.longitude),Ti(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Vi(n[i],r[i]);if(o)return o}return ai(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=ai(r[s],o[s]);if(0!==a)return a;var u=Vi(n[r[s]],i[o[s]]);if(0!==u)return u}return ai(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ni()}}function Ri(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ai(t,e);var n=Ii(t),r=Ii(e),i=ai(n.seconds,r.seconds);return 0!==i?i:ai(n.nanos,r.nanos)}function Mi(t){return Pi(t)}function Pi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Ii(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?_i(t.bytesValue).toBase64():"referenceValue"in t?Ci.fromName(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Pi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Pi(t.fields[o])}return e+"}"}(t.mapValue):ni();var e}function Li(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Fi(t){return!!t&&"integerValue"in t}function qi(t){return!!t&&"arrayValue"in t}function Bi(t){return!!t&&"nullValue"in t}function Ki(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Gi(t){return!!t&&"mapValue"in t}function Qi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},Ii(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return di(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=Qi(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Qi(t.arrayValue.values[r]);return n}return Object.assign({},t)}var zi=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Gi(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Qi(e)},t.prototype.setAll=function(t){var e=this,n=bi.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Qi(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Gi(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return xi(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Gi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){di(e,function(e,n){return t[e]=n});for(var r=0,i=n;r<i.length;r++)delete t[i[r]]},t.prototype.clone=function(){return new t(Qi(this.value))},t}();function Hi(t){var e=[];return di(t.fields,function(t,n){var r=new bi([t]);if(Gi(n)){var i=Hi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new vi(e)}var Wi=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,li.min(),zi.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,zi.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,zi.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=zi.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=zi.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Yi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function $i(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Yi(t,e,n,r,i,o,s)}function Xi(t){var e=ii(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Mi(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+t.dir}(t)}).join(","),Di(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ho(e.startAt)),e.endAt&&(n+="|ub:",n+=ho(e.endAt)),e.h=n}return e.h}function Ji(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!fo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!xi(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!go(t.startAt,e.startAt)&&go(t.endAt,e.endAt)}function Zi(t){return Ci.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var to=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(R.c)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new eo(t,n,r):"array-contains"===n?new oo(t,r):"in"===n?new so(t,r):"not-in"===n?new ao(t,r):"array-contains-any"===n?new uo(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new no(t,n):new ro(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Vi(e,this.value)):null!==e&&ji(this.value)===ji(e)&&this.m(Vi(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ni()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),eo=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Ci.fromName(r.referenceValue),i}return Object(R.c)(e,t),e.prototype.matches=function(t){var e=Ci.comparator(t.key,this.key);return this.m(e)},e}(to),no=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=io(0,n),r}return Object(R.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(to),ro=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=io(0,n),r}return Object(R.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(to);function io(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Ci.fromName(t.referenceValue)})}var oo=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(R.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return qi(e)&&Ui(e.arrayValue,this.value)},e}(to),so=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(R.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ui(this.value.arrayValue,e)},e}(to),ao=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(R.c)(e,t),e.prototype.matches=function(t){if(Ui(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ui(this.value.arrayValue,e)},e}(to),uo=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(R.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!qi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Ui(e.value.arrayValue,t)})},e}(to),co=function(t,e){this.position=t,this.before=e};function ho(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Mi(t)}).join(",")}var lo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function fo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function po(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Ci.comparator(Ci.fromName(s.referenceValue),n.key):Vi(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function go(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!xi(t.position[n],e.position[n]))return!1;return!0}var mo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null};function yo(t,e,n,r,i,o,s,a){return new mo(t,e,n,r,i,o,s,a)}function bo(t){return new mo(t)}function vo(t){return!Di(t.limit)&&"F"===t.limitType}function wo(t){return!Di(t.limit)&&"L"===t.limitType}function Eo(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Io(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function To(t){return null!==t.collectionGroup}function _o(t){var e=ii(t);if(null===e.p){e.p=[];var n=Io(e),r=Eo(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new lo(n)),e.p.push(new lo(bi.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new lo(bi.keyField(),u))}}}return e.p}function Oo(t){var e=ii(t);if(!e.T)if("F"===e.limitType)e.T=$i(e.path,e.collectionGroup,_o(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=_o(e);r<i.length;r++){var o=i[r];n.push(new lo(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new co(e.endAt.position,!e.endAt.before):null,a=e.startAt?new co(e.startAt.position,!e.startAt.before):null;e.T=$i(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.T}function Ao(t,e,n){return new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function So(t,e){return Ji(Oo(t),Oo(e))&&t.limitType===e.limitType}function Do(t){return Xi(Oo(t))+"|lt:"+t.limitType}function ko(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Mi(e.value);var e}).join(", ")+"]"),Di(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ho(t.startAt)),t.endAt&&(e+=", endAt: "+ho(t.endAt)),"Target("+e+")"}(Oo(t))+"; limitType="+t.limitType+")"}function No(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ci.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!po(t.startAt,_o(t),e)||t.endAt&&po(t.endAt,_o(t),e))}(t,e)}function Co(t){return function(e,n){for(var r=!1,i=0,o=_o(t);i<o.length;i++){var s=o[i],a=jo(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function jo(t,e,n){var r=t.field.isKeyField()?Ci.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Vi(r,i):ni()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ni()}}function xo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ki(e)?"-0":e}}function Uo(t){return{integerValue:""+t}}function Vo(t,e){return Ni(e)?Uo(e):xo(t,e)}var Ro=function(){this._=void 0};function Mo(t,e,n){return t instanceof Fo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof qo?Bo(t,e):t instanceof Ko?Go(t,e):function(t,e){var n=Lo(t,e),r=zo(n)+zo(t.A);return Fi(n)&&Fi(t.A)?Uo(r):xo(t.R,r)}(t,e)}function Po(t,e,n){return t instanceof qo?Bo(t,e):t instanceof Ko?Go(t,e):n}function Lo(t,e){return t instanceof Qo?Fi(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Fo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(R.c)(e,t),e}(Ro),qo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(R.c)(e,t),e}(Ro);function Bo(t,e){for(var n=Ho(e),r=function(t){n.some(function(e){return xi(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ko=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(R.c)(e,t),e}(Ro);function Go(t,e){for(var n=Ho(e),r=function(t){n=n.filter(function(e){return!xi(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Qo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(R.c)(e,t),e}(Ro);function zo(t){return Ti(t.integerValue||t.doubleValue)}function Ho(t){return qi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Wo=function(t,e){this.field=t,this.transform=e},Yo=function(t,e){this.version=t,this.transformResults=e},$o=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Xo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Jo=function(){};function Zo(t,e,n){t instanceof is?function(t,e,n){var r=t.value.clone(),i=as(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof os?function(t,e,n){if(Xo(t.precondition,e)){var r=as(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(ss(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function ts(t,e,n){t instanceof is?function(t,e,n){if(Xo(t.precondition,e)){var r=t.value.clone(),i=us(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(rs(e),r).setHasLocalMutations()}}(t,e,n):t instanceof os?function(t,e,n){if(Xo(t.precondition,e)){var r=us(t.fieldTransforms,n,e),i=e.data;i.setAll(ss(t)),i.setAll(r),e.convertToFoundDocument(rs(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Xo(t.precondition,e)&&e.convertToNoDocument(li.min())}(t,e)}function es(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Lo(o.transform,s||null);null!=a&&(null==n&&(n=zi.empty()),n.set(o.field,a))}return n||null}function ns(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ui(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof qo&&e instanceof qo||t instanceof Ko&&e instanceof Ko?ui(t.elements,e.elements,xi):t instanceof Qo&&e instanceof Qo?xi(t.A,e.A):t instanceof Fo&&e instanceof Fo}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function rs(t){return t.isFoundDocument()?t.version:li.min()}var is=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(R.c)(e,t),e}(Jo),os=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(R.c)(e,t),e}(Jo);function ss(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function as(t,e,n){var r=new Map;ri(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Po(s,a,n[i]))}return r}function us(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Mo(a,u,e))}return r}var cs,hs,ls=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(R.c)(e,t),e}(Jo),fs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(R.c)(e,t),e}(Jo),ds=function(t){this.count=t};function ps(t){switch(t){case Wr.OK:return ni();case Wr.CANCELLED:case Wr.UNKNOWN:case Wr.DEADLINE_EXCEEDED:case Wr.RESOURCE_EXHAUSTED:case Wr.INTERNAL:case Wr.UNAVAILABLE:case Wr.UNAUTHENTICATED:return!1;case Wr.INVALID_ARGUMENT:case Wr.NOT_FOUND:case Wr.ALREADY_EXISTS:case Wr.PERMISSION_DENIED:case Wr.FAILED_PRECONDITION:case Wr.ABORTED:case Wr.OUT_OF_RANGE:case Wr.UNIMPLEMENTED:case Wr.DATA_LOSS:return!0;default:return ni()}}function gs(t){if(void 0===t)return Zr("GRPC error has no .code"),Wr.UNKNOWN;switch(t){case cs.OK:return Wr.OK;case cs.CANCELLED:return Wr.CANCELLED;case cs.UNKNOWN:return Wr.UNKNOWN;case cs.DEADLINE_EXCEEDED:return Wr.DEADLINE_EXCEEDED;case cs.RESOURCE_EXHAUSTED:return Wr.RESOURCE_EXHAUSTED;case cs.INTERNAL:return Wr.INTERNAL;case cs.UNAVAILABLE:return Wr.UNAVAILABLE;case cs.UNAUTHENTICATED:return Wr.UNAUTHENTICATED;case cs.INVALID_ARGUMENT:return Wr.INVALID_ARGUMENT;case cs.NOT_FOUND:return Wr.NOT_FOUND;case cs.ALREADY_EXISTS:return Wr.ALREADY_EXISTS;case cs.PERMISSION_DENIED:return Wr.PERMISSION_DENIED;case cs.FAILED_PRECONDITION:return Wr.FAILED_PRECONDITION;case cs.ABORTED:return Wr.ABORTED;case cs.OUT_OF_RANGE:return Wr.OUT_OF_RANGE;case cs.UNIMPLEMENTED:return Wr.UNIMPLEMENTED;case cs.DATA_LOSS:return Wr.DATA_LOSS;default:return ni()}}(hs=cs||(cs={}))[hs.OK=0]="OK",hs[hs.CANCELLED=1]="CANCELLED",hs[hs.UNKNOWN=2]="UNKNOWN",hs[hs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hs[hs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hs[hs.NOT_FOUND=5]="NOT_FOUND",hs[hs.ALREADY_EXISTS=6]="ALREADY_EXISTS",hs[hs.PERMISSION_DENIED=7]="PERMISSION_DENIED",hs[hs.UNAUTHENTICATED=16]="UNAUTHENTICATED",hs[hs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hs[hs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hs[hs.ABORTED=10]="ABORTED",hs[hs.OUT_OF_RANGE=11]="OUT_OF_RANGE",hs[hs.UNIMPLEMENTED=12]="UNIMPLEMENTED",hs[hs.INTERNAL=13]="INTERNAL",hs[hs.UNAVAILABLE=14]="UNAVAILABLE",hs[hs.DATA_LOSS=15]="DATA_LOSS";var ms=function(){function t(t,e){this.comparator=t,this.root=e||bs.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,bs.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bs.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new ys(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new ys(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new ys(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new ys(this.root,t,this.comparator,!0)},t}(),ys=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),bs=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw ni();if(this.right.isRed())throw ni();var t=this.left.check();if(t!==this.right.check())throw ni();return t+(this.isRed()?0:1)},t}();bs.EMPTY=null,bs.RED=!0,bs.BLACK=!1,bs.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ni()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ni()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ni()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ni()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ni()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new bs(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var vs=function(){function t(t){this.comparator=t,this.data=new ms(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new ws(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new ws(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),ws=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Es=new ms(Ci.comparator);function Is(){return Es}var Ts=new ms(Ci.comparator);function _s(){return Ts}var Os=new ms(Ci.comparator);function As(){return Os}var Ss=new vs(Ci.comparator);function Ds(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ss,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ks=new vs(ai);function Ns(){return ks}var Cs=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,js.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(li.min(),r,Ns(),Is(),Ds())},t}(),js=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(wi.EMPTY_BYTE_STRING,n,Ds(),Ds(),Ds())},t}(),xs=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Us=function(t,e){this.targetId=t,this.V=e},Vs=function(t,e,n,r){void 0===n&&(n=wi.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Rs=function(){function t(){this.S=0,this.D=Ls(),this.C=wi.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Ds(),e=Ds(),n=Ds();return this.D.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ni()}}),new js(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Ls()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Ms=function(){function t(t){this.W=t,this.G=new Map,this.H=Is(),this.J=Ps(),this.Y=new vs(ai)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:ni()}})},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Zi(i))if(0===n){var o=new Ci(i.path);this.tt(e,o,Wi.newNoDocument(o,li.min()))}else ri(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&Zi(o.target)){var s=new Ci(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Wi.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=Ds();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Cs(t,n,this.Y,this.H,r);return this.H=Is(),this.J=Ps(),this.Y=new vs(ai),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Rs,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new vs(ai),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Jr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Rs),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Ps(){return new ms(Ci.comparator)}function Ls(){return new ms(Ci.comparator)}var Fs={asc:"ASCENDING",desc:"DESCENDING"},qs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Bs=function(t,e){this.databaseId=t,this.I=e};function Ks(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gs(t,e){return t.I?e.toBase64():e.toUint8Array()}function Qs(t,e){return Ks(t,e.toTimestamp())}function zs(t){return ri(!!t),li.fromTimestamp(function(t){var e=Ii(t);return new hi(e.seconds,e.nanos)}(t))}function Hs(t,e){return function(t){return new mi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Ws(t){var e=mi.fromString(t);return ri(ba(e)),e}function Ys(t,e){return Hs(t.databaseId,e.path)}function $s(t,e){var n=Ws(e);if(n.get(1)!==t.databaseId.projectId)throw new Yr(Wr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Yr(Wr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ci(ta(n))}function Xs(t,e){return Hs(t.databaseId,e)}function Js(t){var e=Ws(t);return 4===e.length?mi.emptyPath():ta(e)}function Zs(t){return new mi(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ta(t){return ri(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function ea(t,e,n){return{name:Ys(t,e),fields:n.value.mapValue.fields}}function na(t,e,n){var r=$s(t,e.name),i=zs(e.updateTime),o=new zi({mapValue:{fields:e.fields}}),s=Wi.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function ra(t,e){var n;if(e instanceof is)n={update:ea(t,e.key,e.value)};else if(e instanceof ls)n={delete:Ys(t,e.key)};else if(e instanceof os)n={update:ea(t,e.key,e.data),updateMask:ya(e.fieldMask)};else{if(!(e instanceof fs))return ni();n={verify:Ys(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Fo)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof qo)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ko)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Qo)return{fieldPath:e.field.canonicalString(),increment:n.A};throw ni()}(0,t)})),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Qs(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ni()}(t,e.precondition)),n}function ia(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?$o.updateTime(zs(t.updateTime)):void 0!==t.exists?$o.exists(t.exists):$o.none()}(e.currentDocument):$o.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(ri("REQUEST_TIME"===e.setToServerValue),n=new Fo):"appendMissingElements"in e?n=new qo(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Ko(e.removeAllFromArray.values||[]):"increment"in e?n=new Qo(t,e.increment):ni();var r=bi.fromServerFormat(e.fieldPath);return new Wo(r,n)}(t,e)}):[];if(e.update){var i=$s(t,e.update.name),o=new zi({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new vi((t.fieldPaths||[]).map(function(t){return bi.fromServerFormat(t)}))}(e.updateMask);return new os(i,o,s,n,r)}return new is(i,o,n,r)}if(e.delete){var a=$s(t,e.delete);return new ls(a,n)}if(e.verify){var u=$s(t,e.verify);return new fs(u,n)}return ni()}function oa(t,e){return{documents:[Xs(t,e.path)]}}function sa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Xs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xs(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Ki(t.value))return{unaryFilter:{field:da(t.field),op:"IS_NAN"}};if(Bi(t.value))return{unaryFilter:{field:da(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ki(t.value))return{unaryFilter:{field:da(t.field),op:"IS_NOT_NAN"}};if(Bi(t.value))return{unaryFilter:{field:da(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:da(t.field),op:fa(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:da(t.field),direction:la(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Di(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=ca(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ca(e.endAt)),n}function aa(t){var e=Js(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ri(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=ua(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new lo(pa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return Di(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ha(n.startAt));var h=null;return n.endAt&&(h=ha(n.endAt)),yo(e,i,a,s,u,"F",c,h)}function ua(t){return t?void 0!==t.unaryFilter?[ma(t)]:void 0!==t.fieldFilter?[ga(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return ua(t)}).reduce(function(t,e){return t.concat(e)}):ni():[]}function ca(t){return{before:t.before,values:t.position}}function ha(t){return new co(t.values||[],!!t.before)}function la(t){return Fs[t]}function fa(t){return qs[t]}function da(t){return{fieldPath:t.canonicalString()}}function pa(t){return bi.fromServerFormat(t.fieldPath)}function ga(t){return to.create(pa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ni()}}(t.fieldFilter.op),t.fieldFilter.value)}function ma(t){switch(t.unaryFilter.op){case"IS_NAN":var e=pa(t.unaryFilter.field);return to.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=pa(t.unaryFilter.field);return to.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=pa(t.unaryFilter.field);return to.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=pa(t.unaryFilter.field);return to.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ni()}}function ya(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}}function ba(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function va(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ea(e)),e=wa(t.get(n),e);return Ea(e)}function wa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Ea(t){return t+"\x01\x01"}function Ia(t){var e=t.length;if(ri(e>=2),2===e)return ri("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),mi.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&ni(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:ni()}o=s+2}return new mi(r)}var Ta=function(t,e){this.seconds=t,this.nanoseconds=e},_a=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};_a.store="owner",_a.key="owner";var Oa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Oa.store="mutationQueues",Oa.keyPath="userId";var Aa=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Aa.store="mutations",Aa.keyPath="batchId",Aa.userMutationsIndex="userMutationsIndex",Aa.userMutationsKeyPath=["userId","batchId"];var Sa=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,va(e)]},t.key=function(t,e,n){return[t,va(e),n]},t}();Sa.store="documentMutations",Sa.PLACEHOLDER=new Sa;var Da=function(t,e){this.path=t,this.readTime=e},ka=function(t,e){this.path=t,this.version=e},Na=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Na.store="remoteDocuments",Na.readTimeIndex="readTimeIndex",Na.readTimeIndexPath="readTime",Na.collectionReadTimeIndex="collectionReadTimeIndex",Na.collectionReadTimeIndexPath=["parentPath","readTime"];var Ca=function(t){this.byteSize=t};Ca.store="remoteDocumentGlobal",Ca.key="remoteDocumentGlobalKey";var ja=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ja.store="targets",ja.keyPath="targetId",ja.queryTargetsIndexName="queryTargetsIndex",ja.queryTargetsKeyPath=["canonicalId","targetId"];var xa=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};xa.store="targetDocuments",xa.keyPath=["targetId","path"],xa.documentTargetsIndex="documentTargetsIndex",xa.documentTargetsKeyPath=["path","targetId"];var Ua=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ua.key="targetGlobalKey",Ua.store="targetGlobal";var Va=function(t,e){this.collectionId=t,this.parent=e};Va.store="collectionParents",Va.keyPath=["collectionId","parent"];var Ra=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ra.store="clientMetadata",Ra.keyPath="clientId";var Ma=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Ma.store="bundles",Ma.keyPath="bundleId";var Pa=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Pa.store="namedQueries",Pa.keyPath="name";var La=Object(R.f)(Object(R.f)([],Object(R.f)(Object(R.f)([],Object(R.f)(Object(R.f)([],Object(R.f)(Object(R.f)([],[Oa.store,Aa.store,Sa.store,Na.store,ja.store,_a.store,Ua.store,xa.store]),[Ra.store])),[Ca.store])),[Va.store])),[Ma.store,Pa.store]),Fa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",qa=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),Ba=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Ka=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&ni(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Ga=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Ba,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Ha(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Ja(e.target.error);n.ft.reject(new Ha(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Ha(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Jr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ya(e)},t}(),Qa=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Object(M.j)())&&Zr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Jr("SimpleDb","Removing database:",t),$a(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(M.j)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Object(R.b)(this,void 0,void 0,function(){var e,n=this;return Object(R.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Jr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Ha(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Yr(Wr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Ha(t,n))},i.onupgradeneeded=function(t){Jr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Jr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(R.b)(this,void 0,void 0,function(){var i,o,s,a,u;return Object(R.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Object(R.d)(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Ga.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Ka.reject(t)}).toPromise(),u={},s.catch(function(){}),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return Jr("SimpleDb","Transaction failed with error:",(c=l.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),za=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return $a(this.Pt.delete())},t}(),Ha=function(t){function e(e,n){var r=this;return(r=t.call(this,Wr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(R.c)(e,t),e}(Yr);function Wa(t){return"IndexedDbTransactionError"===t.name}var Ya=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Jr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Jr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),$a(n)},t.prototype.add=function(t){return Jr("SimpleDb","ADD",this.store.name,t,t),$a(this.store.add(t))},t.prototype.get=function(t){var e=this;return $a(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Jr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Jr("SimpleDb","DELETE",this.store.name,t),$a(this.store.delete(t))},t.prototype.count=function(){return Jr("SimpleDb","COUNT",this.store.name),$a(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){Jr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Ka(function(n,r){e.onerror=function(t){var e=Ja(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new Ka(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new za(i),s=e(i.primaryKey,i.value,o);if(s instanceof Ka){var a=s.catch(function(t){return o.done(),Ka.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return Ka.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function $a(t){return new Ka(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Ja(t.target.error);n(e)}})}var Xa=!1;function Ja(t){var e=Qa._t(Object(M.j)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Yr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Xa||(Xa=!0,setTimeout(function(){throw r},0)),r}}return t}var Za=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(R.c)(e,t),e}(qa);function tu(t,e){var n=ii(t);return Qa.It(n.Mt,e)}var eu=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Zo(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&ts(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&ts(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(li.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ds())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ui(this.mutations,t.mutations,function(t,e){return ns(t,e)})&&ui(this.baseMutations,t.baseMutations,function(t,e){return ns(t,e)})},t}(),nu=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){ri(e.mutations.length===r.length);for(var i=As(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),ru=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=li.min()),void 0===o&&(o=li.min()),void 0===s&&(s=wi.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),iu=function(t){this.Lt=t};function ou(t,e){if(e.document)return na(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ci.fromSegments(e.noDocument.path),r=hu(e.noDocument.readTime),i=Wi.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Ci.fromSegments(e.unknownDocument.path);return r=hu(e.unknownDocument.version),Wi.newUnknownDocument(o,r)}return ni()}function su(t,e,n){var r=au(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Ys(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Ks(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new Na(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=cu(e.version);return s=e.hasCommittedMutations,new Na(null,new Da(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=cu(e.version);return new Na(new ka(c,h),null,null,!0,r,i)}return ni()}function au(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function uu(t){var e=new hi(t[0],t[1]);return li.fromTimestamp(e)}function cu(t){var e=t.toTimestamp();return new Ta(e.seconds,e.nanoseconds)}function hu(t){var e=new hi(t.seconds,t.nanoseconds);return li.fromTimestamp(e)}function lu(t,e){for(var n=(e.baseMutations||[]).map(function(e){return ia(t.Lt,e)}),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map(function(e){return ia(t.Lt,e)}),o=hi.fromMillis(e.localWriteTimeMs);return new eu(e.batchId,o,n,i)}function fu(t){var e,n,r=hu(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?hu(t.lastLimboFreeSnapshotVersion):li.min();return void 0!==t.query.documents?(ri(1===(n=t.query).documents.length),e=Oo(bo(Js(n.documents[0])))):e=function(t){return Oo(aa(t))}(t.query),new ru(e,t.targetId,0,t.lastListenSequenceNumber,r,i,wi.fromBase64String(t.resumeToken))}function du(t,e){var n,r=cu(e.snapshotVersion),i=cu(e.lastLimboFreeSnapshotVersion);n=Zi(e.target)?oa(t.Lt,e.target):sa(t.Lt,e.target);var o=e.resumeToken.toBase64();return new ja(e.targetId,Xi(e.target),r,o,e.sequenceNumber,i,n)}function pu(t){var e=aa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ao(e,e.limit,"L"):e}var gu=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return mu(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:hu(e.createTime),version:e.version};var e})},t.prototype.saveBundleMetadata=function(t,e){return mu(t).put({bundleId:(n=e).id,createTime:cu(zs(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return yu(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:pu(e.bundledQuery),readTime:hu(e.readTime)};var e})},t.prototype.saveNamedQuery=function(t,e){return yu(t).put(function(t){return{name:t.name,readTime:cu(zs(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function mu(t){return tu(t,Ma.store)}function yu(t){return tu(t,Pa.store)}var bu=function(){function t(){this.Bt=new vu}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Ka.resolve()},t.prototype.getCollectionParents=function(t,e){return Ka.resolve(this.Bt.getEntries(e))},t}(),vu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new vs(mi.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new vs(mi.comparator)).toArray()},t}(),wu=function(){function t(){this.qt=new vu}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:va(i)};return Eu(t).put(o)}return Ka.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ci(e),""],!1,!0);return Eu(t).Nt(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ia(o.parent))}return n})},t}();function Eu(t){return tu(t,Va.store)}var Iu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Tu=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function _u(t,e,n){var r=t.store(Aa.store),i=t.store(Sa.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){ri(1===a)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=Sa.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Ka.waitFor(o).next(function(){return c})}function Ou(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ni();e=t.noDocument}return JSON.stringify(e).length}Tu.DEFAULT_COLLECTION_PERCENTILE=10,Tu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tu.DEFAULT=new Tu(41943040,Tu.DEFAULT_COLLECTION_PERCENTILE,Tu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tu.DISABLED=new Tu(-1,0,0);var Au=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return ri(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Du(t).$t({index:Aa.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=ku(t),s=Du(t);return s.add({}).next(function(a){ri("number"==typeof a);for(var u=new eu(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return ra(t.Lt,e)}),i=n.mutations.map(function(e){return ra(t.Lt,e)});return new Aa(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new vs(function(t,e){return ai(t.canonicalString(),e.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],g=Sa.key(i.userId,p.key.path,a);l=l.add(p.key.path.popLast()),h.push(s.put(c)),h.push(o.put(g,Sa.PLACEHOLDER))}return l.forEach(function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Kt[a]=u.keys()}),Ka.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Du(t).get(e).next(function(t){return t?(ri(t.userId===n.userId),lu(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Ka.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Du(t).$t({index:Aa.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(ri(e.batchId>=r),o=lu(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Du(t).$t({index:Aa.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Du(t).Nt(Aa.userMutationsIndex,n).next(function(t){return t.map(function(t){return lu(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Sa.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ku(t).$t({range:i},function(r,i,s){var a=r[0],u=r[2],c=Ia(r[1]);if(a===n.userId&&e.path.isEqual(c))return Du(t).get(u).next(function(t){if(!t)throw ni();ri(t.userId===n.userId),o.push(lu(n.R,t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new vs(ai),i=[];return e.forEach(function(e){var o=Sa.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=ku(t).$t({range:s},function(t,i,o){var s=t[0],a=t[2],u=Ia(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),Ka.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Sa.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new vs(ai);return ku(t).$t({range:s},function(t,e,o){var s=t[0],u=t[2],c=Ia(t[1]);s===n.userId&&r.isPrefixOf(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Du(t).get(e).next(function(t){if(null===t)throw ni();ri(t.userId===n.userId),r.push(lu(n.R,t))}))}),Ka.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return _u(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),Ka.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Ka.resolve();var r=IDBKeyRange.lowerBound(Sa.prefixForUser(e.userId)),i=[];return ku(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=Ia(t[1]);i.push(o)}else r.done()}).next(function(){ri(0===i.length)})})},t.prototype.containsKey=function(t,e){return Su(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Nu(t).get(this.userId).next(function(t){return t||new Oa(e.userId,-1,"")})},t}();function Su(t,e,n){var r=Sa.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return ku(t).$t({range:o,kt:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Du(t){return tu(t,Aa.store)}function ku(t){return tu(t,Sa.store)}function Nu(t){return tu(t,Oa.store)}var Cu=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),ju=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new Cu(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return li.fromTimestamp(new hi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return xu(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return ri(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return xu(t).$t(function(s,a){var u=fu(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return Ka.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return xu(t).$t(function(t,n){var r=fu(n);e(r)})},t.prototype.Xt=function(t){return Uu(t).get(Ua.key).next(function(t){return ri(null!==t),t})},t.prototype.Zt=function(t,e){return Uu(t).put(Ua.key,e)},t.prototype.te=function(t,e){return xu(t).put(du(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=Xi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return xu(t).$t({range:r,index:ja.queryTargetsIndexName},function(t,n,r){var o=fu(n);Ji(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Vu(t);return e.forEach(function(e){var s=va(e.path);i.push(o.put(new xa(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),Ka.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Vu(t);return Ka.forEach(e,function(e){var o=va(e.path);return Ka.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Vu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Vu(t),i=Ds();return r.$t({range:n,kt:!0},function(t,e,n){var r=Ia(t[1]),o=new Ci(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=va(e.path),r=IDBKeyRange.bound([n],[ci(n)],!1,!0),i=0;return Vu(t).$t({index:xa.documentTargetsIndex,kt:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.lt=function(t,e){return xu(t).get(e).next(function(t){return t?fu(t):null})},t}();function xu(t){return tu(t,ja.store)}function Uu(t){return tu(t,Ua.store)}function Vu(t){return tu(t,xa.store)}function Ru(t){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(e){if(t.code!==Wr.FAILED_PRECONDITION||t.message!==Fa)throw t;return Jr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Mu(t,e){var n=t[1],r=e[1],i=ai(t[0],e[0]);return 0===i?ai(n,r):i}var Pu=function(){function t(t){this.ne=t,this.buffer=new vs(Mu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Mu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Lu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Jr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(R.b)(e,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Wa(e=n.sent())?(Jr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ru(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),Fu=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Ka.resolve(Hr.o);var r=new Pu(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Jr("LruGarbageCollector","Garbage collection skipped; disabled"),Ka.resolve(Iu)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Jr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Iu):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>c.params.maximumSequenceNumbersToCollect?(Jr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),Xr()<=P.a.DEBUG&&Jr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Ka.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),qu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Fu(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return Bu(t,n)},t.prototype.removeReference=function(t,e,n){return Bu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Bu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Nu(t).Ot(function(r){return Su(t,r,e).next(function(t){return t&&(n=!0),Ka.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),Vu(t).delete([0,va(s.path)])})});i.push(u)}}).next(function(){return Ka.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Bu(t,e)},t.prototype.we=function(t,e){var n,r=Vu(t),i=Hr.o;return r.$t({index:xa.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Hr.o&&e(new Ci(Ia(n)),i),i=s,n=o):i=Hr.o}).next(function(){i!==Hr.o&&e(new Ci(Ia(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Bu(t,e){return Vu(t).put(function(t,e){return new xa(0,va(t.path),e)}(e,t.currentSequenceNumber))}var Ku=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.equalsFn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){di(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.isEmpty=function(){return pi(this.inner)},t}(),Gu=function(){function t(){this.changes=new Ku(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:li.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Wi.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Ka.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Qu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Wu(t).put(Yu(e),n)},t.prototype.removeEntry=function(t,e){var n=Wu(t),r=Yu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return Wu(t).get(Yu(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return Wu(t).get(Yu(e)).next(function(t){return{document:n.ye(e,t),size:Ou(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=Is();return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=Is(),i=new ms(Ci.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Ou(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Ka.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Wu(t).$t({range:r},function(t,e,r){for(var s=Ci.fromSegments(t);o&&Ci.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Is(),o=e.path.length+1,s={};if(n.isEqual(li.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=au(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Na.collectionReadTimeIndex}return Wu(t).$t(s,function(t,n,s){if(t.length===o){var a=ou(r.R,n);e.path.isPrefixOf(a.key.path)?No(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new zu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Hu(t).get(Ca.key).next(function(t){return ri(!!t),t})},t.prototype.me=function(t,e){return Hu(t).put(Ca.key,e)},t.prototype.ye=function(t,e){if(e){var n=ou(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(li.min()))return n}return Wi.newInvalidDocument(t)},t}(),zu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Ku(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(R.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new vs(function(t,e){return ai(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=su(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Ou(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=su(e.Ie.R,Wi.newNoDocument(o,li.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),Ka.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(Gu);function Hu(t){return tu(t,Ca.store)}function Wu(t){return tu(t,Na.store)}function Yu(t){return t.path.toArray()}var $u=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;ri(n<r&&n>=0&&r<=11);var o=new Ga("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(_a.store)}(t),function(t){t.createObjectStore(Oa.store,{keyPath:Oa.keyPath}),t.createObjectStore(Aa.store,{keyPath:Aa.keyPath,autoIncrement:!0}).createIndex(Aa.userMutationsIndex,Aa.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Sa.store)}(t),Xu(t),function(t){t.createObjectStore(Na.store)}(t));var s=Ka.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(xa.store),t.deleteObjectStore(ja.store),t.deleteObjectStore(Ua.store)}(t),Xu(t)),s=s.next(function(){return function(t){var e=t.store(Ua.store),n=new Ua(0,0,li.min().toTimestamp(),0);return e.put(Ua.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Aa.store).Nt().next(function(n){t.deleteObjectStore(Aa.store),t.createObjectStore(Aa.store,{keyPath:Aa.keyPath,autoIncrement:!0}).createIndex(Aa.userMutationsIndex,Aa.userMutationsKeyPath,{unique:!0});var r=e.store(Aa.store),i=n.map(function(t){return r.put(t)});return Ka.waitFor(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Ra.store,{keyPath:Ra.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Ca.store)}(t),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Na.store);e.createIndex(Na.readTimeIndex,Na.readTimeIndexPath,{unique:!1}),e.createIndex(Na.collectionReadTimeIndex,Na.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(Ma.store,{keyPath:Ma.keyPath})}(t),function(t){t.createObjectStore(Pa.store,{keyPath:Pa.keyPath})}(t)})),s},t.prototype.be=function(t){var e=0;return t.store(Na.store).$t(function(t,n){e+=Ou(n)}).next(function(){var n=new Ca(e);return t.store(Ca.store).put(Ca.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(Oa.store),r=t.store(Aa.store);return n.Nt().next(function(n){return Ka.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Aa.userMutationsIndex,i).next(function(r){return Ka.forEach(r,function(r){ri(r.userId===n.userId);var i=lu(e.R,r);return _u(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(xa.store),n=t.store(Na.store);return t.store(Ua.store).get(Ua.key).next(function(t){var r=[];return n.$t(function(n,i){var o=new mi(n),s=function(t){return[0,va(t)]}(o);r.push(e.get(s).next(function(n){return n?Ka.resolve():function(n){return e.put(new xa(0,va(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Ka.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(Va.store,{keyPath:Va.keyPath});var n=e.store(Va.store),r=new vu,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:va(i)})}};return e.store(Na.store).$t({kt:!0},function(t,e){var n=new mi(t);return i(n.popLast())}).next(function(){return e.store(Sa.store).$t({kt:!0},function(t,e){var n=Ia(t[1]);return i(n.popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(ja.store);return n.$t(function(t,r){var i=fu(r),o=du(e.R,i);return n.put(o)})},t}();function Xu(t){t.createObjectStore(xa.store,{keyPath:xa.keyPath}).createIndex(xa.documentTargetsIndex,xa.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ja.store,{keyPath:ja.keyPath}).createIndex(ja.queryTargetsIndexName,ja.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ua.store)}var Ju="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Zu=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Yr(Wr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new qu(this,i),this.Le=n+"main",this.R=new iu(u),this.Be=new Qa(this.Le,11,new $u(this.R)),this.qe=new ju(this.referenceDelegate,this.R),this.Ut=new wu,this.Ue=function(t,e){return new Qu(t,e)}(this.R,this.Ut),this.Ke=new gu,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Zr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Yr(Wr.FAILED_PRECONDITION,Ju);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new Hr(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(R.b)(e,void 0,void 0,function(){return Object(R.d)(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return Object(R.b)(e,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return Object(R.b)(e,void 0,void 0,function(){return Object(R.d)(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ec(e).put(new Ra(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(Wa(e))return Jr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Jr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return tc(t).get(_a.key).next(function(t){return Ka.resolve(e.tn(t))})},t.prototype.en=function(t){return ec(t).delete(this.clientId)},t.prototype.nn=function(){return Object(R.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(R.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=tu(t,Ra.store);return e.Nt().next(function(t){var n=r.rn(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Ka.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)this.Qe.removeItem(this.on(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Ka.resolve(!0):tc(t).get(_a.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Yr(Wr.FAILED_PRECONDITION,Ju);return!1}}return!(!e.networkEnabled||!e.inForeground)||ec(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Jr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return Object(R.b)(this,void 0,void 0,function(){var t=this;return Object(R.d)(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[_a.store,Ra.store],function(e){var n=new Za(e,Hr.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return ec(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Au.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Jr("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",La,function(o){return r=new Za(o,i.Ne?i.Ne.next():Hr.o),"readwrite-primary"===e?i.Je(r).next(function(t){return!!t||i.Ye(r)}).next(function(e){if(!e)throw Zr("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new Yr(Wr.FAILED_PRECONDITION,Fa);return n(r)}).next(function(t){return i.Ze(r).next(function(){return t})}):i.dn(r).next(function(){return n(r)})}).then(function(t){return r.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return tc(t).get(_a.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Yr(Wr.FAILED_PRECONDITION,Ju)})},t.prototype.Ze=function(t){var e=new _a(this.clientId,this.allowTabSynchronization,Date.now());return tc(t).put(_a.key,e)},t.yt=function(){return Qa.yt()},t.prototype.Xe=function(t){var e=this,n=tc(t);return n.get(_a.key).next(function(t){return e.tn(t)?(Jr("IndexedDbPersistence","Releasing primary lease."),n.delete(_a.key)):Ka.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Zr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Jr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Zr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Zr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function tc(t){return tu(t,_a.store)}function ec(t){return tu(t,Ra.store)}function nc(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var rc=function(t,e){this.progress=t,this.wn=e},ic=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Ci.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):To(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Ci(e)).next(function(t){var e=_s();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=_s();return this.Ut.getCollectionParents(t,i).next(function(s){return Ka.forEach(s,function(s){var a=function(t,e){return new mo(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return o.Rn(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=Wi.newInvalidDocument(c),r=r.insert(c,h)),ts(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(t,n){No(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=Ds(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof os&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},t}(),oc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Ds(),i=Ds(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),sc=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(li.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(o){var s=i.Cn(e,o);return(vo(e)||wo(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(Xr()<=P.a.DEBUG&&Jr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ko(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new vs(Co(t));return e.forEach(function(e,r){No(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Xr()<=P.a.DEBUG&&Jr("QueryEngine","Using full collection scan to execute query:",ko(e)),this.Sn.getDocumentsMatchingQuery(t,e,li.min())},t}(),ac=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new ms(ai),this.kn=new Ku(function(t){return Xi(t)},Ji),this.$n=li.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new ic(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.Fn)})},t}();function uc(t,e,n,r){return new ac(t,e,n,r)}function cc(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(R.d)(this,function(s){switch(s.label){case 0:return n=ii(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new ic(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n=[],r=[],s=Ds(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++)s=s.add(l[h].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var g=0,m=p.mutations;g<m.length;g++)s=s.add(m[g].key)}return i.pn(t,s).next(function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function hc(t,e){var n=ii(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Ka.resolve();return o.forEach(function(t){s=s.next(function(){return r.getEntry(e,t)}).next(function(e){var o=n.docVersions.get(t);ri(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))})}),s.next(function(){return t._n.removeMutationBatch(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}function lc(t){var e=ii(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function fc(t,e){var n=ii(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)}));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return ri(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}});var a=Is();if(e.documentUpdates.forEach(function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),s.push(dc(t,o,e.documentUpdates,r,void 0).next(function(t){a=t})),!r.isEqual(li.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next(function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)});s.push(u)}return Ka.waitFor(s).next(function(){return o.apply(t)}).next(function(){return n.Mn.En(t,a)}).next(function(){return a})}).then(function(t){return n.Fn=i,t})}function dc(t,e,n,r,i){var o=Ds();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=Is();return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(li.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Jr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function pc(t,e){var n=ii(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)})}function gc(t,e){var n=ii(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.qe.getTargetData(t,e).next(function(i){return i?Ka.resolve(r=i):n.qe.allocateTargetId(t).next(function(i){return r=new ru(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next(function(){return r})})})}).then(function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t})}function mc(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(R.d)(this,function(a){switch(a.label){case 0:r=ii(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Wa(s=a.sent()))throw s;return Jr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function yc(t,e,n){var r=ii(t),i=li.min(),o=Ds();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=ii(t),i=r.kn.get(n);return void 0!==i?Ka.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,Oo(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next(function(t){o=t})}).next(function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:li.min(),n?o:Ds())}).next(function(t){return{documents:t,Bn:o}})})}function bc(t,e){var n=ii(t),r=ii(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function vc(t){var e=ii(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=ii(t),i=Is(),o=au(n),s=Wu(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:Na.readTimeIndex,range:a},function(t,e){var n=ou(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:uu(o)}})}(e.On,t,e.$n)}).then(function(t){var n=t.wn;return e.$n=t.readTime,n})}function wc(t){return Object(R.b)(this,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){return[2,(e=ii(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Wu(t),n=li.min();return e.$t({index:Na.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=uu(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.$n=t})]})})}function Ec(t,e,n,r){return Object(R.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,f,d;return Object(R.d)(this,function(p){switch(p.label){case 0:for(i=ii(t),o=Ds(),s=Is(),a=As(),u=0,c=n;u<c.length;u++)l=e.qn((h=c[u]).metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Kn(h.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,gc(i,function(t){return Oo(bo(mi.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return dc(t,f,s,li.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next(function(){return i.qe.addMatchingKeys(t,o,d.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}function Ic(t,e,n){return void 0===n&&(n=Ds()),Object(R.b)(this,void 0,void 0,function(){var r,i;return Object(R.d)(this,function(o){switch(o.label){case 0:return[4,gc(t,Oo(pu(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=ii(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=zs(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(t,e);var s=r.withResumeToken(wi.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Ke.saveNamedQuery(t,e)})})]}})})}var Tc=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Ka.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:zs(n.createTime)}),Ka.resolve()},t.prototype.getNamedQuery=function(t,e){return Ka.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:pu(t.bundledQuery),readTime:zs(t.readTime)}}(e)),Ka.resolve()},t}(),_c=function(){function t(){this.Wn=new vs(Oc.Gn),this.zn=new vs(Oc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Oc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new Oc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new Ci(new mi([])),r=new Oc(n,t),i=new Oc(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Ci(new mi([])),n=new Oc(e,t),r=new Oc(e,t+1),i=Ds();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new Oc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Oc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Ci.comparator(t.key,e.key)||ai(t.ns,e.ns)},t.Hn=function(t,e){return ai(t.ns,e.ns)||Ci.comparator(t.key,e.key)},t}(),Ac=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new vs(Oc.Gn)}return t.prototype.checkEmpty=function(t){return Ka.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new eu(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new Oc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Ka.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Ka.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return Ka.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Ka.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Ka.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Oc(e,0),i=new Oc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),Ka.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new vs(ai);return e.forEach(function(t){var e=new Oc(t,0),i=new Oc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),Ka.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Ci.isDocumentKey(i)||(i=i.child(""));var o=new Oc(new Ci(i),0),s=new vs(ai);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),Ka.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;ri(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Ka.forEach(e.mutations,function(i){var o=new Oc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Oc(e,0),r=this.rs.firstAfterOrEqual(n);return Ka.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return Ka.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Sc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new ms(Ci.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Ka.resolve(n?n.document.clone():Wi.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Is();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Wi.newInvalidDocument(t))}),Ka.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Is(),i=new Ci(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,u=a.document,c=a.readTime;if(!e.path.isPrefixOf(s.key.path))break;c.compareTo(n)<=0||No(e,u)&&(r=r.insert(u.key,u.clone()))}return Ka.resolve(r)},t.prototype.fs=function(t,e){return Ka.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(t){return new Dc(this)},t.prototype.getSize=function(t){return Ka.resolve(this.size)},t}(),Dc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(R.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),Ka.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Gu),kc=function(){function t(t){this.persistence=t,this.ds=new Ku(function(t){return Xi(t)},Ji),this.lastRemoteSnapshotVersion=li.min(),this.highestTargetId=0,this.ws=0,this._s=new _c,this.targetCount=0,this.ys=Cu.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),Ka.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Ka.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Ka.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Ka.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Ka.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Cu(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Ka.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Ka.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Ka.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),Ka.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return Ka.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Ka.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Ka.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),Ka.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Ka.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Ka.resolve(n)},t.prototype.containsKey=function(t,e){return Ka.resolve(this._s.containsKey(e))},t}(),Nc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Hr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new kc(this),this.Ut=new bu,this.Ue=function(t,e){return new Sc(t,function(t){return n.referenceDelegate.ps(t)})}(this.Ut),this.R=new iu(e),this.Ke=new Tc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Ac(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Jr("MemoryPersistence","Starting transaction:",t);var i=new Cc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return Ka.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),Cc=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(R.c)(e,t),e}(qa),jc=function(){function t(t){this.persistence=t,this.As=new _c,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw ni()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Ka.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Ka.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Ka.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ka.forEach(this.vs,function(r){var i=Ci.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Ka.or([function(){return Ka.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),xc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function Uc(t,e){return"firestore_clients_"+t+"_"+e}function Vc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Rc(t,e){return"firestore_targets_"+t+"_"+e}xc.UNAUTHENTICATED=new xc(null),xc.GOOGLE_CREDENTIALS=new xc("google-credentials-uid"),xc.FIRST_PARTY=new xc("first-party-uid");var Mc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Yr(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Zr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Pc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Yr(i.error.code,i.error.message)),o?new t(e,i.state,r):(Zr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Lc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ns(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ni(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Zr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Fc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Zr("SharedClientState","Failed to parse online state: "+e),null)},t}(),qc=function(){function t(){this.activeTargetIds=Ns()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Bc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new ms(ai),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Uc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new qc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(R.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h=this;return Object(R.d)(this,function(l){switch(l.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Uc(this.persistenceKey,r)))&&(o=Lc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)this.Fs(c[u]);return this.$s=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Rc(this.persistenceKey,t));if(n){var r=Pc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Rc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Jr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Jr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Jr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Jr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Zr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(R.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(R.d)(this,function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Hr.o;if(null!=t)try{var n=JSON.parse(t);ri("number"==typeof n),e=n}catch(t){Zr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Hr.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Mc(this.currentUser,t,e,n),i=Vc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Vc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=Rc(this.persistenceKey,t),i=new Pc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Lc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return Mc.Vs(new xc(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Pc.Vs(r,e)},t.prototype.js=function(t){return Fc.Vs(t)},t.prototype.ii=function(t){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Jr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Ns();return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),Kc=function(){function t(){this.li=new qc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new qc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Gc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Qc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Jr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Jr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),zc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Hc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Wc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Object(R.c)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var s=new zr;s.listenOnce(Br.COMPLETE,function(){try{switch(s.getLastErrorCode()){case qr.NO_ERROR:var e=s.getResponseJson();Jr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case qr.TIMEOUT:Jr("Connection",'RPC "'+t+'" timed out'),o(new Yr(Wr.DEADLINE_EXCEEDED,"Request time out"));break;case qr.HTTP_ERROR:var n=s.getStatus();if(Jr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Wr).indexOf(e)>=0?e:Wr.UNKNOWN}(r.status);o(new Yr(a,r.message))}else o(new Yr(Wr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Yr(Wr.UNAVAILABLE,"Connection failed."));break;default:ni()}}finally{Jr("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Rr,i=ke(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Gr({})),this.Fi(o.initMessageHeaders,e),Object(M.o)()||Object(M.q)()||Object(M.m)()||Object(M.n)()||Object(M.r)()||Object(M.l)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Jr("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new Hc({Ei:function(t){c?Jr("Connection","Not sending because WebChannel is closed:",t):(u||(Jr("Connection","Opening WebChannel transport."),a.open(),u=!0),Jr("Connection","WebChannel sending:",t),a.send(t))},Ti:function(){return a.close()}}),l=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(a,Qr.EventType.OPEN,function(){c||Jr("Connection","WebChannel transport opened.")}),l(a,Qr.EventType.CLOSE,function(){c||(c=!0,Jr("Connection","WebChannel transport closed"),h.Vi())}),l(a,Qr.EventType.ERROR,function(t){c||(c=!0,ti("Connection","WebChannel transport errored:",t),h.Vi(new Yr(Wr.UNAVAILABLE,"The operation could not be completed")))}),l(a,Qr.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];ri(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Jr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=cs[t];if(void 0!==e)return gs(e)}(i),s=r.message;void 0===o&&(o=Wr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Vi(new Yr(o,s)),a.close()}else Jr("Connection","WebChannel received:",n),h.Si(n)}}),l(i,Kr.STAT_EVENT,function(t){10===t.stat?Jr("Connection","Detected buffering proxy"):11===t.stat&&Jr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Pi()},0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?"https":"http")+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Jr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return Jr("RestConnection","Received: ",t),t},function(e){throw ti("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.7.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+zc[t]},t}());function Yc(){return"undefined"!=typeof window?window:null}function $c(){return"undefined"!=typeof document?document:null}function Xc(t){return new Bs(t,!0)}var Jc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Jr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Ki=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Zc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Jc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Wr.RESOURCE_EXHAUSTED?(Zr(e.toString()),Zr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Wr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new Yr(Wr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return Object(R.b)(t,void 0,void 0,function(){return Object(R.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return Jr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(Jr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),th=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Object(R.c)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ni()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(ri(void 0===e||"string"==typeof e),wi.fromBase64String(e||"")):(ri(void 0===e||e instanceof Uint8Array),wi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Wr.UNKNOWN:gs(t.code);return new Yr(e,t.message||"")}(a);n=new Vs(r,i,o,s||null)}else if("documentChange"in e){i=$s(t,(r=e.documentChange).document.name),o=zs(r.document.updateTime);var a=new zi({mapValue:{fields:r.document.fields}}),u=(s=Wi.newFoundDocument(i,o,a),r.targetIds||[]);n=new xs(u,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=$s(t,(r=e.documentDelete).document),o=r.readTime?zs(r.readTime):li.min(),a=Wi.newNoDocument(i,o),n=new xs([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in e)i=$s(t,(r=e.documentRemove).document),n=new xs([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return ni();var c=e.filter;i=new ds(r=c.count||0),n=new Us(o=c.targetId,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return li.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?li.min():e.readTime?zs(e.readTime):li.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Zs(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Zi(r)?{documents:oa(t,r)}:{query:sa(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Gs(t,e.resumeToken):e.snapshotVersion.compareTo(li.min())>0&&(n.readTime=Ks(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ni()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Zs(this.R),e.removeTarget=t,this.cr(e)},e}(Zc),eh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Object(R.c)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(ri(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(ri(void 0!==e),t.map(function(t){return function(t,e){var n=zs(t.updateTime?t.updateTime:e);return n.isEqual(li.min())&&(n=zs(e)),new Yo(n,t.transformResults||[])}(t,e)})):[]}(t.writeResults,t.commitTime),n=zs(t.commitTime);return this.listener.Tr(n,e)}return ri(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Zs(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return ra(e.R,t)})};this.cr(n)},e}(Zc),nh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(R.c)(e,t),e.prototype.br=function(){if(this.Rr)throw new Yr(Wr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Wr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Yr(Wr.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Wr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Yr(Wr.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),rh=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Zr(e),this.Vr=!1):Jr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),ih=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return Object(R.b)(o,void 0,void 0,function(){return Object(R.d)(this,function(t){switch(t.label){case 0:return dh(this)?(Jr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(R.b)(this,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){switch(n.label){case 0:return(e=ii(t)).Or.add(4),[4,sh(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,oh(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new rh(n,r)};function oh(t){return Object(R.b)(this,void 0,void 0,function(){var e,n;return Object(R.d)(this,function(r){switch(r.label){case 0:if(!dh(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function sh(t){return Object(R.b)(this,void 0,void 0,function(){var e,n;return Object(R.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ah(t,e){var n=ii(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),fh(n)?lh(n):Dh(n).er()&&ch(n,e))}function uh(t,e){var n=ii(t),r=Dh(n);n.$r.delete(e),r.er()&&hh(n,e),0===n.$r.size&&(r.er()?r.ir():dh(n)&&n.Br.set("Unknown"))}function ch(t,e){t.qr.U(e.targetId),Dh(t).mr(e)}function hh(t,e){t.qr.U(e),Dh(t).yr(e)}function lh(t){t.qr=new Ms({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Dh(t).start(),t.Br.Sr()}function fh(t){return dh(t)&&!Dh(t).tr()&&t.$r.size>0}function dh(t){return 0===ii(t).Or.size}function ph(t){t.qr=void 0}function gh(t){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(e){return t.$r.forEach(function(e,n){ch(t,e)}),[2]})})}function mh(t,e){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(n){return ph(t),fh(t)?(t.Br.Nr(e),lh(t)):t.Br.set("Unknown"),[2]})})}function yh(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i,o;return Object(R.d)(this,function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Vs&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(R.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.$r.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Jr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,bh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof xs?t.qr.X(e):e instanceof Us?t.qr.rt(e):t.qr.et(e),n.isEqual(li.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,lc(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(wi.EMPTY_BYTE_STRING,n.snapshotVersion)),hh(t,e);var r=new ru(n.target,e,1,n.sequenceNumber);ch(t,r)}}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Jr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,bh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function bh(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r=this;return Object(R.d)(this,function(i){switch(i.label){case 0:if(!Wa(e))throw e;return t.Or.add(1),[4,sh(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return lc(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return Object(R.b)(r,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return Jr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,oh(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function vh(t,e){return e().catch(function(n){return bh(t,n,e)})}function wh(t){return Object(R.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(R.d)(this,function(s){switch(s.label){case 0:e=ii(t),n=kh(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return dh(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,pc(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=kh(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,bh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Eh(e)&&Ih(e),[2]}})})}function Eh(t){return dh(t)&&!kh(t).tr()&&t.kr.length>0}function Ih(t){kh(t).start()}function Th(t){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(e){return kh(t).Ar(),[2]})})}function _h(t){return Object(R.b)(this,void 0,void 0,function(){var e,n,r;return Object(R.d)(this,function(i){for(e=kh(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]})})}function Oh(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i;return Object(R.d)(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=nu.from(r,e,n),[4,vh(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,wh(t)];case 2:return o.sent(),[2]}})})}function Ah(t,e){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(n){switch(n.label){case 0:return e&&kh(t).pr?[4,function(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r;return Object(R.d)(this,function(i){switch(i.label){case 0:return ps(r=e.code)&&r!==Wr.ABORTED?(n=t.kr.shift(),kh(t).sr(),[4,vh(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,wh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Eh(t)&&Ih(t),[2]}})})}function Sh(t,e){return Object(R.b)(this,void 0,void 0,function(){var n;return Object(R.d)(this,function(r){switch(r.label){case 0:return n=ii(t),e?(n.Or.delete(2),[4,oh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,sh(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Dh(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=ii(t);return r.br(),new th(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:gh.bind(null,t),Ri:mh.bind(null,t),_r:yh.bind(null,t)}),t.Mr.push(function(n){return Object(R.b)(e,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return n?(t.Ur.sr(),fh(t)?lh(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),ph(t),e.label=3;case 3:return[2]}})})})),t.Ur}function kh(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=ii(t);return r.br(),new eh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Th.bind(null,t),Ri:Ah.bind(null,t),Ir:_h.bind(null,t),Tr:Oh.bind(null,t)}),t.Mr.push(function(n){return Object(R.b)(e,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,wh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(Jr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}})})})),t.Kr}var Nh=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ba,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Yr(Wr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Ch(t,e){if(Zr("AsyncQueue",e+": "+t),Wa(t))return new Yr(Wr.UNAVAILABLE,e+": "+t);throw t}var jh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Ci.comparator(e.key,n.key)}:function(t,e){return Ci.comparator(t.key,e.key)},this.keyedMap=_s(),this.sortedSet=new ms(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),xh=function(){function t(){this.Qr=new ms(Ci.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):ni():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Uh=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,jh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&So(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Vh=function(){this.Wr=void 0,this.listeners=[]},Rh=function(){this.queries=new Ku(function(t){return Do(t)},So),this.onlineState="Unknown",this.Gr=new Set};function Mh(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(R.d)(this,function(c){switch(c.label){case 0:if(n=ii(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Vh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Ch(a,"Initialization of query '"+ko(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&qh(n),[2]}})})}function Ph(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(R.d)(this,function(a){return n=ii(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function Lh(t,e){for(var n=ii(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&qh(n)}function Fh(t,e,n){var r=ii(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function qh(t){t.Gr.forEach(function(t){t.next()})}var Bh=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Uh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Uh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Kh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),Gh=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return $s(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?na(this.R,t.document,!1):Wi.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return zs(t)},t}();!function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new Gh(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||Ds()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(R.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(R.d)(this,function(o){switch(o.label){case 0:return[4,Ec(this.localStore,new Gh(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,Ic(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new rc(Object.assign({},this.progress),t))]}})})}}();var Qh=function(t){this.key=t},zh=function(t){this.key=t},Hh=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Ds(),this.mutatedKeys=Ds(),this.lo=Co(t),this.fo=new jh(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new xh,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=vo(this.query)&&i.size===this.query.limit?i.last():null,c=wo(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=No(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),vo(this.query)||wo(this.query))for(;s.size>this.query.limit;){var h=vo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ni()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Uh(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new xh,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Ds(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new zh(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new Qh(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Ds();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Uh.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Wh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Yh=function(t){this.key=t,this.bo=!1},$h=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Ku(function(t){return Do(t)},So),this.Vo=new Map,this.So=new Set,this.Do=new ms(Ci.comparator),this.Co=new Map,this.No=new _c,this.xo={},this.Fo=new Map,this.ko=Cu.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function Xh(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(R.d)(this,function(a){switch(a.label){case 0:return n=Al(t),(i=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,gc(n.localStore,Oo(e))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,Jh(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.isPrimaryClient&&ah(n.remoteStore,o),a.label=4;case 4:return[2,r]}})})}function Jh(t,e,n,r){return Object(R.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(R.d)(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Object(R.b)(this,void 0,void 0,function(){var i,o,s;return Object(R.d)(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,yc(t.localStore,e.query,!1).then(function(t){return e.view._o(t.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(ll(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,yc(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Hh(e,i.Bn),s=o._o(i.documents),a=js.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),ll(t,n,u.To),c=new Wh(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function Zh(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i;return Object(R.d)(this,function(o){switch(o.label){case 0:return n=ii(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!So(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,mc(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),uh(n.remoteStore,r.targetId),cl(n,r.targetId)}).catch(Ru)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return cl(n,r.targetId),[4,mc(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function tl(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(R.d)(this,function(a){switch(a.label){case 0:r=Sl(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=ii(t),i=hi.now(),o=e.reduce(function(t,e){return t.add(e.key)},Ds());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Mn.pn(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=es(c,n.get(c.key));null!=h&&s.push(new os(c.key,h,Hi(h.value.mapValue),$o.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)})}).then(function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}})}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new ms(ai)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,pl(r,i.changes)];case 3:return a.sent(),[4,wh(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Ch(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function el(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r;return Object(R.d)(this,function(i){switch(i.label){case 0:n=ii(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,fc(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&(ri(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?ri(r.bo):t.removedDocuments.size>0&&(ri(r.bo),r.bo=!1))}),[4,pl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ru(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function nl(t,e,n){var r=ii(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=ii(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)}),r&&qh(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function rl(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(R.d)(this,function(c){switch(c.label){case 0:return(r=ii(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new ms(Ci.comparator)).insert(o,Wi.newNoDocument(o,li.min())),a=Ds().add(o),u=new Cs(li.min(),new Map,new vs(ai),s,a),[4,el(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),dl(r),[3,4];case 2:return[4,mc(r.localStore,e,!1).then(function(){return cl(r,e,n)}).catch(Ru)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function il(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i;return Object(R.d)(this,function(o){switch(o.label){case 0:n=ii(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,hc(n.localStore,e)];case 2:return i=o.sent(),ul(n,r,null),al(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,pl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ru(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function ol(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i;return Object(R.d)(this,function(o){switch(o.label){case 0:r=ii(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=ii(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n._n.lookupMutationBatch(t,e).next(function(e){return ri(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(r.localStore,e)];case 2:return i=o.sent(),ul(r,e,n),al(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,pl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ru(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function sl(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(R.d)(this,function(a){switch(a.label){case 0:dh((n=ii(t)).remoteStore)||Jr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=ii(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Ch(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function al(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function ul(t,e,n){var r=ii(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function cl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||hl(t,e)})}function hl(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(uh(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),dl(t))}function ll(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Qh?(t.No.addReference(o.key,e),fl(t,o)):o instanceof zh?(Jr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||hl(t,o.key)):ni()}}function fl(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Jr("SyncEngine","New document in limbo: "+n),t.So.add(r),dl(t))}function dl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Ci(mi.fromString(e)),r=t.ko.next();t.Co.set(r,new Yh(n)),t.Do=t.Do.insert(n,r),ah(t.remoteStore,new ru(Oo(bo(n.path)),r,2,Hr.o))}}function pl(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(R.d)(this,function(a){switch(a.label){case 0:return r=ii(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,a){s.push(r.Oo(a,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=oc.Pn(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(R.d)(this,function(h){switch(h.label){case 0:n=ii(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Ka.forEach(e,function(e){return Ka.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return Ka.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Wa(r=h.sent()))throw r;return Jr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.Fn.get(a),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.Fn=n.Fn.insert(a,c));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function gl(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r;return Object(R.d)(this,function(i){switch(i.label){case 0:return(n=ii(t)).currentUser.isEqual(e)?[3,3]:(Jr("SyncEngine","User change. New user:",e.toKey()),[4,cc(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach(function(t){t.forEach(function(t){t.reject(new Yr(Wr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,pl(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function ml(t,e){var n=ii(t),r=n.Co.get(e);if(r&&r.bo)return Ds().add(r.key);var i=Ds(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Po.get(a[s]);i=i.unionWith(u.view.wo)}return i}function yl(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i;return Object(R.d)(this,function(o){switch(o.label){case 0:return[4,yc((n=ii(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&ll(n,e.targetId,i.To),i)]}})})}function bl(t){return Object(R.b)(this,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){return[2,vc((e=ii(t)).localStore).then(function(t){return pl(e,t)})]})})}function vl(t,e,n,r){return Object(R.b)(this,void 0,void 0,function(){var i,o;return Object(R.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=ii(t),r=ii(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.jt(t,e).next(function(e){return e?n.Mn.pn(t,e):Ka.resolve(null)})})}((i=ii(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,wh(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(ul(i,e,r||null),al(i,e),function(t,e){ii(ii(t)._n).Gt(e)}(i.localStore,e)):ni(),s.label=4;case 4:return[4,pl(i,o)];case 5:return s.sent(),[3,7];case 6:Jr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function wl(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(R.d)(this,function(c){switch(c.label){case 0:return Al(n=ii(t)),Sl(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,El(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,Sh(n.remoteStore,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)ah(n.remoteStore,s[o]);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(a=[],u=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?a.push(e):u=u.then(function(){return cl(n,e),mc(n.localStore,e,!0)}),uh(n.remoteStore,e)}),[4,u]);case 4:return c.sent(),[4,El(n,a)];case 5:return c.sent(),function(t){var e=ii(t);e.Co.forEach(function(t,n){uh(e.remoteStore,n)}),e.No.ts(),e.Co=new Map,e.Do=new ms(Ci.comparator)}(n),n.$o=!1,[4,Sh(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function El(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,f,d,p;return Object(R.d)(this,function(g){switch(g.label){case 0:n=ii(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(u=void 0,(c=n.Vo.get(a=s[o]))&&0!==c.length?[4,gc(n.localStore,Oo(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=n.Po.get(l[h]),[4,yl(n,f)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,bc(n.localStore,a)];case 8:return p=g.sent(),[4,gc(n.localStore,p)];case 9:return u=g.sent(),[4,Jh(n,Il(p),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function Il(t){return yo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Tl(t){var e=ii(t);return ii(ii(e.localStore).persistence).fn()}function _l(t,e,n,r){return Object(R.b)(this,void 0,void 0,function(){var i,o,s;return Object(R.d)(this,function(a){switch(a.label){case 0:return(i=ii(t)).$o?(Jr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,vc(i.localStore)];case 3:return o=a.sent(),s=Cs.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,pl(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,mc(i.localStore,e,!0)];case 6:return a.sent(),cl(i,e,r),[3,8];case 7:ni(),a.label=8;case 8:return[2]}})})}function Ol(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l;return Object(R.d)(this,function(f){switch(f.label){case 0:if(!(r=Al(t)).$o)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(Jr("SyncEngine","Adding an already active target "+s),[3,5]):[4,bc(r.localStore,s)]:[3,6];case 2:return a=f.sent(),[4,gc(r.localStore,a)];case 3:return u=f.sent(),[4,Jh(r,Il(a),u.targetId,!1)];case 4:f.sent(),ah(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(R.d)(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,mc(r.localStore,t,!1).then(function(){uh(r.remoteStore,t),cl(r,t)}).catch(Ru)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function Al(t){var e=ii(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=el.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ml.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rl.bind(null,e),e.vo._r=Lh.bind(null,e.eventManager),e.vo.Mo=Fh.bind(null,e.eventManager),e}function Sl(t){var e=ii(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=il.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ol.bind(null,e),e}var Dl=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return this.R=Xc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}})})},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return uc(this.persistence,new sc,t.initialUser,this.R)},t.prototype.qo=function(t){return new Nc(jc.bs,this.R)},t.prototype.Bo=function(t){return new Kc},t.prototype.terminate=function(){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),kl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(R.c)(e,t),e.prototype.initialize=function(e){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,wc(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,Sl(this.Qo.syncEngine)];case 4:return n.sent(),[4,wh(this.Qo.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Ko=function(t){return uc(this.persistence,new sc,t.initialUser,this.R)},e.prototype.Uo=function(t){return new Lu(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=nc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Tu.withCacheSize(this.cacheSizeBytes):Tu.DEFAULT;return new Zu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Yc(),$c(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Kc},e}(Dl),Nl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(R.c)(e,t),e.prototype.initialize=function(e){return Object(R.b)(this,void 0,void 0,function(){var n,r=this;return Object(R.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Bc?(this.sharedClientState.syncEngine={ui:vl.bind(null,n),ai:_l.bind(null,n),hi:Ol.bind(null,n),fn:Tl.bind(null,n),ci:bl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return Object(R.b)(r,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return[4,wl(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=Yc();if(!Bc.yt(e))throw new Yr(Wr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=nc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Bc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(kl),Cl=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(R.b)(this,void 0,void 0,function(){var n=this;return Object(R.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return nl(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=gl.bind(null,this.syncEngine),[4,Sh(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(t){return new Rh},t.prototype.createDatastore=function(t){var e=Xc(t.databaseInfo.databaseId),n=new Wc(t.databaseInfo);return function(t,e,n){return new nh(t,e,n)}(t.credentials,n,e)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return nl(s.syncEngine,t,0)},o=Qc.yt()?new Qc:new Gc,new ih(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new $h(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(R.b)(this,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){switch(n.label){case 0:return e=ii(t),Jr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,sh(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}(),jl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),xl=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Ba,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return Object(R.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(R.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Kh(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.Jo=function(){return Object(R.b)(this,void 0,void 0,function(){var t,e;return Object(R.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return Object(R.b)(this,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return Object(R.b)(this,void 0,void 0,function(){var t,e;return Object(R.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(R.b)(this,void 0,void 0,function(){var e,n=this;return Object(R.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Yr(Wr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(R.d)(this,function(u){switch(u.label){case 0:return n=ii(t),r=Zs(n.R)+"/documents",i={documents:e.map(function(t){return Ys(n.R,t)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){ri(!!e.found);var n=$s(t,e.found.name),r=zs(e.found.updateTime),i=new zi({mapValue:{fields:e.found.fields}});return Wi.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){ri(!!e.missing),ri(!!e.readTime);var n=$s(t,e.missing),r=zs(e.readTime);return Wi.newNoDocument(n,r)}(t,e):ni()}(n.R,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());ri(!!e),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new ls(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(R.b)(this,void 0,void 0,function(){var t,e=this;return Object(R.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Ci.fromPath(n);e.mutations.push(new fs(r,e.precondition(r)))}),[4,function(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i;return Object(R.d)(this,function(o){switch(o.label){case 0:return n=ii(t),r=Zs(n.R)+"/documents",i={writes:e.map(function(t){return ra(n.R,t)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw ni();e=li.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(Wr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?$o.updateTime(e):$o.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(li.min()))throw new Yr(Wr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $o.updateTime(e)}return $o.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),Ul=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Jc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return Object(R.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(R.d)(this,function(r){return t=new xl(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Di(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ps(e)}return!1},t}(),Vl=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=xc.UNAUTHENTICATED,this.clientId=si.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return Object(R.b)(r,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return Jr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Yr(Wr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Ba;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(R.b)(t,void 0,void 0,function(){var t,n;return Object(R.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Ch(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function Rl(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(R.d)(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Jr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return Object(R.b)(i,void 0,void 0,function(){return Object(R.d)(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,cc(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function Ml(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r;return Object(R.d)(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Pl(t)];case 1:return n=i.sent(),Jr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return Object(R.b)(this,void 0,void 0,function(){var n,r;return Object(R.d)(this,function(i){switch(i.label){case 0:return(n=ii(t)).asyncQueue.verifyOperationInProgress(),Jr("RemoteStore","RemoteStore received new credentials"),r=dh(n),n.Or.add(3),[4,sh(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,oh(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function Pl(t){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Jr("FirestoreClient","Using default OfflineComponentProvider"),[4,Rl(t,new Dl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function Ll(t){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Jr("FirestoreClient","Using default OnlineComponentProvider"),[4,Ml(t,new Cl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function Fl(t){return Pl(t).then(function(t){return t.persistence})}function ql(t){return Pl(t).then(function(t){return t.localStore})}function Bl(t){return Ll(t).then(function(t){return t.remoteStore})}function Kl(t){return Ll(t).then(function(t){return t.syncEngine})}function Gl(t){return Object(R.b)(this,void 0,void 0,function(){var e,n;return Object(R.d)(this,function(r){switch(r.label){case 0:return[4,Ll(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Xh.bind(null,e.syncEngine),n.onUnlisten=Zh.bind(null,e.syncEngine),n)]}})})}function Ql(t,e,n){var r=this;void 0===n&&(n={});var i=new Ba;return t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(r,void 0,void 0,function(){var r;return Object(R.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new jl({next:function(o){e.enqueueAndForget(function(){return Ph(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Yr(Wr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Yr(Wr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Bh(bo(n.path),o,{includeMetadataChanges:!0,so:!0});return Mh(t,s)},[4,Gl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function zl(t,e,n){var r=this;void 0===n&&(n={});var i=new Ba;return t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(r,void 0,void 0,function(){var r;return Object(R.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new jl({next:function(n){e.enqueueAndForget(function(){return Ph(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Yr(Wr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Bh(n,o,{includeMetadataChanges:!0,so:!0});return Mh(t,s)},[4,Gl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}var Hl=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Wl=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Yl=new Map,$l=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Xl=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(xc.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Jl=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Zl=function(){function t(t){var e=this;this.currentUser=xc.UNAUTHENTICATED,this.oc=new Ba,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){Jr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Jr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc!==e?(Jr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(ri("string"==typeof n.accessToken),new $l(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return Object(R.b)(n,void 0,void 0,function(){return Object(R.d)(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return ri(null===t||"string"==typeof t),new xc(t)},t}(),tf=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=xc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),ef=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new tf(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(xc.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function nf(t,e,n){if(!n)throw new Yr(Wr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function rf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function of(t,e,n,r){if(!0===e&&!0===r)throw new Yr(Wr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function sf(t){if(!Ci.isDocumentKey(t))throw new Yr(Wr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function af(t){if(Ci.isDocumentKey(t))throw new Yr(Wr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function uf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ni()}function cf(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Yr(Wr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=uf(t);throw new Yr(Wr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function hf(t,e){if(e<=0)throw new Yr(Wr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var lf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(Wr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Yr(Wr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,of("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),ff=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lf({}),this._settingsFrozen=!1,t instanceof Wl?(this._databaseId=t,this._credentials=new Xl):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Yr(Wr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wl(t.options.projectId)}(t),this._credentials=new Zl(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Yr(Wr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Yr(Wr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lf(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Xl;switch(t.type){case"gapi":var e=t.client;return ri(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ef(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Yr(Wr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Yl.get(this))&&(Jr("ComponentProvider","Removing Datastore"),Yl.delete(this),t.terminate()),Promise.resolve();var t},t}(),df=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new gf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),pf=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),gf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,bo(r))||this)._path=r,i.type="collection",i}return Object(R.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new df(this.firestore,null,new Ci(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(pf);function mf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(M.i)(t),nf("collection","path",e),t instanceof ff)return af(n=mi.fromString.apply(mi,Object(R.f)([e],r))),new gf(t,null,n);if(!(t instanceof df||t instanceof gf))throw new Yr(Wr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return af(n=mi.fromString.apply(mi,Object(R.f)([t.path],r)).child(mi.fromString(e))),new gf(t.firestore,null,n)}function yf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(M.i)(t),1===arguments.length&&(e=si.u()),nf("doc","path",e),t instanceof ff)return sf(n=mi.fromString.apply(mi,Object(R.f)([e],r))),new df(t,null,new Ci(n));if(!(t instanceof df||t instanceof gf))throw new Yr(Wr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return sf(n=t._path.child(mi.fromString.apply(mi,Object(R.f)([e],r)))),new df(t.firestore,t instanceof gf?t.converter:null,new Ci(n))}function bf(t,e){return t=Object(M.i)(t),e=Object(M.i)(e),(t instanceof df||t instanceof gf)&&(e instanceof df||e instanceof gf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function vf(t,e){return t=Object(M.i)(t),e=Object(M.i)(e),t instanceof pf&&e instanceof pf&&t.firestore===e.firestore&&So(t._query,e._query)&&t.converter===e.converter}var wf=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Jc(this,"async_queue_retry"),this.Tc=function(){var e=$c();e&&Jr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=$c();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=$c();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise(function(t){}):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.Rc()})},t.prototype.Rc=function(){return Object(R.b)(this,void 0,void 0,function(){var t,e=this;return Object(R.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Wa(t=n.sent()))throw t;return Jr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return e.Rc()}),n.label=5;case 5:return[2]}})})},t.prototype.Ac=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){throw e.yc=t,e.gc=!1,Zr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=Nh.createAndSchedule(this,t,e,n,function(t){return r.bc(t)});return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&ni()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return Object(R.b)(this,void 0,void 0,function(){var t;return Object(R.d)(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()})},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function Ef(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new Ba,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var If=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new wf,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Object(R.c)(e,t),e.prototype._terminate=function(){return this._firestoreClient||_f(this),this._firestoreClient.terminate()},e}(ff);function Tf(t){return t._firestoreClient||_f(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function _f(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Hl(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Vl(t._credentials,t._queue,r)}function Of(t,e,n){var r=this,i=new Ba;return t.asyncQueue.enqueue(function(){return Object(R.b)(r,void 0,void 0,function(){var r;return Object(R.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Rl(t,n)];case 1:return o.sent(),[4,Ml(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Wr.FAILED_PRECONDITION||t.code===Wr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Af(t){if(t._initialized||t._terminated)throw new Yr(Wr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Sf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bi(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Df=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(wi.fromBase64String(e))}catch(e){throw new Yr(Wr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(wi.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),kf=function(t){this._methodName=t},Nf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Yr(Wr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Yr(Wr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return ai(this._lat,t._lat)||ai(this._long,t._long)},t}(),Cf=/^__.*__$/,jf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new os(t,this.data,this.fieldMask,e,this.fieldTransforms):new is(t,this.data,e,this.fieldTransforms)},t}(),xf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new os(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function Uf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ni()}}var Vf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return ed(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(Uf(this.Cc)&&Cf.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),Rf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Xc(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new Vf({Cc:t,methodName:e,Bc:n,path:bi.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Mf(t){var e=t._freezeSettings(),n=Xc(t._databaseId);return new Rf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Pf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);Xf("Data must be an object, but it was:",s,r);var a,u,c=Yf(r,s);if(o.merge)a=new vi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=Jf(e,f[l],n);if(!s.contains(d))throw new Yr(Wr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");nd(h,d)||h.push(d)}a=new vi(h),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new jf(new zi(c),a,u)}var Lf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(R.c)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw t.Mc(1===t.Cc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(kf);function Ff(t,e,n){return new Vf({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(R.c)(e,t),e.prototype._toFieldTransform=function(t){return new Wo(t.path,new Fo)},e.prototype.isEqual=function(t){return t instanceof e},e}(kf),Bf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(R.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Ff(this,t,!0),n=this.Uc.map(function(t){return Wf(t,e)}),r=new qo(n);return new Wo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(kf),Kf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(R.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Ff(this,t,!0),n=this.Uc.map(function(t){return Wf(t,e)}),r=new Ko(n);return new Wo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(kf),Gf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(R.c)(e,t),e.prototype._toFieldTransform=function(t){var e=new Qo(t.R,Vo(t.R,this.Kc));return new Wo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(kf);function Qf(t,e,n,r){var i=t.qc(1,e,n);Xf("Data must be an object, but it was:",i,r);var o=[],s=zi.empty();di(r,function(t,r){var a=td(e,t,n);r=Object(M.i)(r);var u=i.$c(a);if(r instanceof Lf)o.push(a);else{var c=Wf(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new vi(o);return new xf(s,a,i.fieldTransforms)}function zf(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[Jf(e,r,n)],u=[i];if(o.length%2!=0)throw new Yr(Wr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Jf(e,o[c])),u.push(o[c+1]);for(var h=[],l=zi.empty(),f=a.length-1;f>=0;--f)if(!nd(h,a[f])){var d=a[f],p=u[f];p=Object(M.i)(p);var g=s.$c(d);if(p instanceof Lf)h.push(d);else{var m=Wf(p,g);null!=m&&(h.push(d),l.set(d,m))}}var y=new vi(h);return new xf(l,y,s.fieldTransforms)}function Hf(t,e,n,r){return void 0===r&&(r=!1),Wf(n,t.qc(r?4:3,e))}function Wf(t,e){if($f(t=Object(M.i)(t)))return Xf("Unsupported field value:",e,t),Yf(t,e);if(t instanceof kf)return function(t,e){if(!Uf(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Wf(o[i],e.Oc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(M.i)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vo(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=hi.fromDate(t);return{timestampValue:Ks(e.R,n)}}if(t instanceof hi)return n=new hi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ks(e.R,n)};if(t instanceof Nf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Df)return{bytesValue:Gs(e.R,t._byteString)};if(t instanceof df){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Hs(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+uf(t))}(t,e)}function Yf(t,e){var n={};return pi(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):di(t,function(t,r){var i=Wf(r,e.xc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function $f(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof hi||t instanceof Nf||t instanceof Df||t instanceof df||t instanceof kf)}function Xf(t,e,n){if(!$f(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=uf(n);throw e.Mc("an object"===r?t+" a custom object":t+" "+r)}}function Jf(t,e,n){if((e=Object(M.i)(e))instanceof Sf)return e._internalPath;if("string"==typeof e)return td(t,e);throw ed("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Zf=new RegExp("[~\\*/\\[\\]]");function td(t,e,n){if(e.search(Zf)>=0)throw ed("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Sf.bind.apply(Sf,Object(R.f)([void 0],e.split(".")))))._internalPath}catch(ep){throw ed("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function ed(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Yr(Wr.INVALID_ARGUMENT,(a+=". ")+t+u)}function nd(t,e){return t.some(function(t){return t.isEqual(e)})}var rd=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new df(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new id(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(od("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),id=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(R.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(rd);function od(t,e){return"string"==typeof e?td(t,e):e instanceof Sf?e._internalPath:e._delegate._internalPath}var sd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),ad=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Object(R.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new ud(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(od("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(rd),ud=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(R.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(ad),cd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new sd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new ud(n._firestore,n._userDataWriter,r.key,r,new sd(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Yr(Wr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:"added",doc:new ud(t._firestore,t._userDataWriter,e.doc.key,e.doc,new sd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new ud(t._firestore,t._userDataWriter,e.doc.key,e.doc,new sd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:hd(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function hd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ni()}}function ld(t,e){return t instanceof ad&&e instanceof ad?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof cd&&e instanceof cd&&t._firestore===e._firestore&&vf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function fd(t){if(wo(t)&&0===t.explicitOrderBy.length)throw new Yr(Wr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var dd=function(){};function pd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var gd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qc=e,i.jc=n,i.Wc=r,i.type="where",i}return Object(R.c)(e,t),e.prototype._apply=function(t){var e=Mf(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Id(s,o);for(var u=[],c=0,h=s;c<h.length;c++)u.push(Ed(r,t,h[c]));a={arrayValue:{values:u}}}else a=Ed(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Id(s,o),a=Hf(n,"where",s,"in"===o||"not-in"===o);var l=to.create(i,o,a);return function(t,e){if(e.g()){var n=Io(t);if(null!==n&&!n.isEqual(e.field))throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Eo(t);null!==r&&Td(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Yr(Wr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t._query,0,e,t.firestore._databaseId,this.Qc,this.jc,this.Wc);return new pf(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(dd),md=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qc=e,r.Gc=n,r.type="orderBy",r}return Object(R.c)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new lo(e,n);return function(t,e){if(null===Eo(t)){var n=Io(t);null!==n&&Td(0,n,e.field)}}(t,r),r}(t._query,this.Qc,this.Gc);return new pf(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new mo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(dd),yd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return Object(R.c)(e,t),e.prototype._apply=function(t){return new pf(t.firestore,t.converter,Ao(t._query,this.zc,this.Hc))},e}(dd),bd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(R.c)(e,t),e.prototype._apply=function(t){var e=wd(t,this.type,this.Jc,this.Yc);return new pf(t.firestore,t.converter,function(t,e){return new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(dd),vd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(R.c)(e,t),e.prototype._apply=function(t){var e=wd(t,this.type,this.Jc,this.Yc);return new pf(t.firestore,t.converter,function(t,e){return new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(dd);function wd(t,e,n,r){if(n[0]=Object(M.i)(n[0]),n[0]instanceof rd)return function(t,e,n,r,i){if(!r)throw new Yr(Wr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=_o(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Li(e,r.key));else{var c=r.data.field(u.field);if(Oi(c))throw new Yr(Wr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new co(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Mf(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Yr(Wr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!To(t)&&-1!==c.indexOf("/"))throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(mi.fromString(c));if(!Ci.isDocumentKey(h))throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Ci(h);a.push(Li(e,l))}else{var f=Hf(n,r,c);a.push(f)}}return new co(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Ed(t,e,n){if("string"==typeof(n=Object(M.i)(n))){if(""===n)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!To(e)&&-1!==n.indexOf("/"))throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(mi.fromString(n));if(!Ci.isDocumentKey(r))throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Li(t,new Ci(r))}if(n instanceof df)return Li(t,n._key);throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+uf(n)+".")}function Id(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Td(t,e,n){if(!n.isEqual(e))throw new Yr(Wr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var _d=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),ji(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ti(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(_i(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw ni()}},t.prototype.convertObject=function(t,e){var n=this,r={};return di(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new Nf(Ti(t.latitude),Ti(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Ai(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Si(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Ii(t);return new hi(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=mi.fromString(t);ri(ba(n));var r=new Wl(n.get(1),n.get(3)),i=new Ci(n.popFirst(5));return r.isEqual(e)||Zr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function Od(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ad=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(R.c)(e,t),e.prototype.convertBytes=function(t){return new Df(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new df(this.firestore,null,e)},e}(_d),Sd=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Mf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Dd(t,this._firestore),i=Od(r.converter,e,n),o=Pf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,$o.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Dd(t,this._firestore);return o="string"==typeof(e=Object(M.i)(e))||e instanceof Sf?zf(this._dataReader,"WriteBatch.update",s._key,e,n,r):Qf(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,$o.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Dd(t,this._firestore);return this._mutations=this._mutations.concat(new ls(e._key,$o.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Yr(Wr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Dd(t,e){if((t=Object(M.i)(t)).firestore!==e)throw new Yr(Wr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var kd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(R.c)(e,t),e.prototype.convertBytes=function(t){return new Df(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new df(this.firestore,null,e)},e}(_d);function Nd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=cf(t,df);var o=cf(t.firestore,If),s=Mf(o);return jd(o,[("string"==typeof(e=Object(M.i)(e))||e instanceof Sf?zf(s,"updateDoc",t._key,e,n,r):Qf(s,"updateDoc",t._key,e)).toMutation(t._key,$o.exists(!0))])}function Cd(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(M.i)(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||Ef(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(Ef(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof df)c=cf(t.firestore,If),h=bo(t._key.path),u={next:function(e){i[a]&&i[a](xd(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=cf(t,pf);c=cf(d.firestore,If),h=d._query;var p=new kd(c);u={next:function(t){i[a]&&i[a](new cd(c,p,d,t))},error:i[a+1],complete:i[a+2]},fd(t._query)}return function(t,e,n,r){var i=this,o=new jl(r),s=new Bh(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(i,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){switch(n.label){case 0:return e=Mh,[4,Gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(i,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){switch(n.label){case 0:return e=Ph,[4,Gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(Tf(c),h,l,u)}function jd(t,e){return function(t,e){var n=this,r=new Ba;return t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(n,void 0,void 0,function(){var n;return Object(R.d)(this,function(i){switch(i.label){case 0:return n=tl,[4,Kl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Tf(t),e)}function xd(t,e,n){var r=n.docs.get(e._key),i=new kd(t);return new ad(t,i,e._key,r,new sd(n.hasPendingWrites,n.fromCache),e.converter)}var Ud=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(R.c)(e,t),e.prototype.get=function(e){var n=this,r=Dd(e,this._firestore),i=new kd(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new ad(n._firestore,i,r._key,t._document,new sd(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Mf(t)}return t.prototype.get=function(t){var e=this,n=Dd(t,this._firestore),r=new Ad(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return ni();var i=t[0];if(i.isFoundDocument())return new rd(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new rd(e._firestore,r,n._key,null,n.converter);throw ni()})},t.prototype.set=function(t,e,n){var r=Dd(t,this._firestore),i=Od(r.converter,e,n),o=Pf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Dd(t,this._firestore);return o="string"==typeof(e=Object(M.i)(e))||e instanceof Sf?zf(this._dataReader,"Transaction.update",s._key,e,n,r):Qf(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Dd(t,this._firestore);return this._transaction.delete(e._key),this},t}());function Vd(){if("undefined"==typeof Uint8Array)throw new Yr(Wr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Rd(){if("undefined"==typeof atob)throw new Yr(Wr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Md=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Rd(),new t(Df.fromBase64String(e))},t.fromUint8Array=function(e){return Vd(),new t(Df.fromUint8Array(e))},t.prototype.toBase64=function(){return Rd(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Vd(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Pd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Af(t=cf(t,If));var n=Tf(t),r=t._freezeSettings(),i=new Cl;return Of(n,i,new kl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Af(t=cf(t,If));var e=Tf(t),n=t._freezeSettings(),r=new Cl;return Of(e,r,new Nl(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Yr(Wr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Ba;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(R.b)(e,void 0,void 0,function(){var e;return Object(R.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(R.b)(this,void 0,void 0,function(){return Object(R.d)(this,function(e){switch(e.label){case 0:return Qa.yt()?[4,Qa.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(nc(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),Ld=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Wl||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||ti("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=cf(t,ff))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&ti("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=Object(M.e)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Yr(Wr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Jl(new $l(o,new xc(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(R.b)(e,void 0,void 0,function(){var e,n;return Object(R.d)(this,function(r){switch(r.label){case 0:return[4,Fl(t)];case 1:return e=r.sent(),[4,Bl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=ii(t);return e.Or.delete(0),oh(e)}(n))]}})})})}(Tf(cf(this._delegate,If)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(R.b)(e,void 0,void 0,function(){var e,n;return Object(R.d)(this,function(r){switch(r.label){case 0:return[4,Fl(t)];case 1:return e=r.sent(),[4,Bl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(R.b)(this,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){switch(n.label){case 0:return(e=ii(t)).Or.add(0),[4,sh(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(Tf(cf(this._delegate,If)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&of("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Ba;return t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(e,void 0,void 0,function(){var e;return Object(R.d)(this,function(r){switch(r.label){case 0:return e=sl,[4,Kl(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Tf(cf(this._delegate,If)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new jl(e);return t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(n,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){ii(t).Gr.add(e),e.next()},[4,Gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(n,void 0,void 0,function(){var e;return Object(R.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){ii(t).Gr.delete(e)},[4,Gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Tf(t=cf(t,If)),Ef(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Yr(Wr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Zd(this,mf(this._delegate,t))}catch(t){throw Qd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Gd(this,yf(this._delegate,t))}catch(t){throw Qd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new $d(this,function(t,e){if(t=cf(t,ff),nf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new pf(t,null,function(t){return new mo(mi.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Qd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Ba;return t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(n,void 0,void 0,function(){var n;return Object(R.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Ll(t).then(function(t){return t.datastore})}(t)];case 1:return n=i.sent(),new Ul(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(Tf(t),function(n){return e(new Ud(t,n))})}(this._delegate,function(n){return t(new qd(e,n))})},t.prototype.batch=function(){var t=this;return Tf(this._delegate),new Bd(new Sd(this._delegate,function(e){return jd(t._delegate,e)}))},t.prototype.loadBundle=function(t){throw new Yr(Wr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Yr(Wr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Fd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(R.c)(e,t),e.prototype.convertBytes=function(t){return new Md(new Df(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Gd.tu(e,this.firestore,null)},e}(_d),qd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Fd(t)}return t.prototype.get=function(t){var e=this,n=tp(t);return this._delegate.get(n).then(function(t){return new Wd(e._firestore,new ad(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=tp(t);return n?(rf("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=tp(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(R.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=tp(t);return this._delegate.delete(e),this},t}(),Bd=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=tp(t);return n?(rf("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=tp(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(R.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=tp(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Kd=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new ud(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Yd(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Fd(e),n),i.set(n,o)),o},t}();Kd.nu=new WeakMap;var Gd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Fd(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Yr(Wr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new df(n._delegate,r,new Ci(e)))},t.tu=function(e,n,r){return new t(n,new df(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Zd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Zd(this.firestore,mf(this._delegate,t))}catch(t){throw Qd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Object(M.i)(t))instanceof df&&bf(this._delegate,t)},t.prototype.set=function(t,e){e=rf("DocumentReference.set",e);try{return function(t,e,n){t=cf(t,df);var r=cf(t.firestore,If),i=Od(t.converter,e,n);return jd(r,[Pf(Mf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,$o.none())])}(this._delegate,t,e)}catch(t){throw Qd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Nd(this._delegate,t):Nd.apply(void 0,Object(R.f)([this._delegate,t,e],n))}catch(t){throw Qd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return jd(cf((t=this._delegate).firestore,If),[new ls(t._key,$o.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=zd(e),i=Hd(e,function(e){return new Wd(t.firestore,new ad(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return Cd(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=cf(t,df);var e=cf(t.firestore,If),n=Tf(e),r=new kd(e);return function(t,e){var n=this,r=new Ba;return t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(n,void 0,void 0,function(){var n;return Object(R.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i;return Object(R.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=ii(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)})}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Yr(Wr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Ch(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,ql(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._key).then(function(n){return new ad(e,r,t._key,n,new sd(null!==n&&n.hasLocalMutations,!0),t.converter)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=cf(t,df);var e=cf(t.firestore,If);return Ql(Tf(e),t._key,{source:"server"}).then(function(n){return xd(e,t,n)})}(this._delegate):function(t){t=cf(t,df);var e=cf(t.firestore,If);return Ql(Tf(e),t._key).then(function(n){return xd(e,t,n)})}(this._delegate)).then(function(t){return new Wd(e.firestore,new ad(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Kd.eu(this.firestore,e):null))},t}();function Qd(t,e,n){return t.message=t.message.replace(e,n),t}function zd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Ef(r))return r}return{}}function Hd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Ef(t[0])?t[0]:Ef(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Wd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Gd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return ld(this._delegate,t._delegate)},t}(),Yd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(R.c)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Wd),$d=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Fd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,pd(this._delegate,function(t,e,n){var r=e,i=od("where",t);return new gd(i,r,n)}(e,n,r)))}catch(e){throw Qd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,pd(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=od("orderBy",t);return new md(r,n)}(e,n)))}catch(e){throw Qd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,pd(this._delegate,function(t){return hf("limit",t),new yd("limit",t,"F")}(e)))}catch(e){throw Qd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,pd(this._delegate,function(t){return hf("limitToLast",t),new yd("limitToLast",t,"L")}(e)))}catch(e){throw Qd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,pd(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bd("startAt",t,!0)}).apply(void 0,e)))}catch(e){throw Qd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,pd(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bd("startAfter",t,!1)}).apply(void 0,e)))}catch(e){throw Qd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,pd(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vd("endBefore",t,!0)}).apply(void 0,e)))}catch(e){throw Qd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,pd(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vd("endAt",t,!1)}).apply(void 0,e)))}catch(e){throw Qd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return vf(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=cf(t,pf);var e=cf(t.firestore,If),n=Tf(e),r=new kd(e);return function(t,e){var n=this,r=new Ba;return t.asyncQueue.enqueueAndForget(function(){return Object(R.b)(n,void 0,void 0,function(){var n;return Object(R.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(R.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(R.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,yc(t,e,!0)];case 1:return a=u.sent(),r=new Hh(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Ch(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,ql(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._query).then(function(n){return new cd(e,r,t,n)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=cf(t,pf);var e=cf(t.firestore,If),n=Tf(e),r=new kd(e);return zl(n,t._query,{source:"server"}).then(function(n){return new cd(e,r,t,n)})}(this._delegate):function(t){t=cf(t,pf);var e=cf(t.firestore,If),n=Tf(e),r=new kd(e);return fd(t._query),zl(n,t._query).then(function(n){return new cd(e,r,t,n)})}(this._delegate)).then(function(t){return new Jd(e.firestore,new cd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=zd(e),i=Hd(e,function(e){return new Jd(t.firestore,new cd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return Cd(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Kd.eu(this.firestore,e):null))},t}(),Xd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Yd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Jd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new $d(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new Yd(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new Xd(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new Yd(n._firestore,r))})},t.prototype.isEqual=function(t){return ld(this._delegate,t._delegate)},t}(),Zd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(R.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Gd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Gd(this.firestore,void 0===t?yf(this._delegate):yf(this._delegate,t))}catch(t){throw Qd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=cf(t.firestore,If),r=yf(t),i=Od(t.converter,e);return jd(n,[Pf(Mf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,$o.exists(!1))]).then(function(){return r})}(this._delegate,t).then(function(t){return new Gd(e.firestore,t)})},e.prototype.isEqual=function(t){return bf(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?Kd.eu(this.firestore,t):null))},e}($d);function tp(t){return cf(t,df)}var ep,np=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Sf.bind.apply(Sf,Object(R.f)([void 0],t)))}return t.documentId=function(){return new t(bi.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(M.i)(t))instanceof Sf&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),rp=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new qf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Lf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Bf("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Kf("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Gf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),ip=n("/6Yf"),op={Firestore:Ld,GeoPoint:Nf,Timestamp:hi,Blob:Md,Transaction:qd,WriteBatch:Bd,DocumentReference:Gd,DocumentSnapshot:Wd,Query:$d,QueryDocumentSnapshot:Yd,QuerySnapshot:Jd,CollectionReference:Zd,FieldPath:np,FieldValue:rp,setLogLevel:function(t){$r.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new ip.a("firestore",function(t){return function(t,e){return new Ld(t,new If(t,e),new Pd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},op)))})(ep=V.a),ep.registerVersion("@firebase/firestore","2.3.8");var sp=n("UbJi");function ap(t,e){return function(t,e=I.b){return new T.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function up(t,e){return ap(t,e).pipe(Object(D.a)(t=>({payload:t,type:"query"})))}function cp(t,e){return up(t,e).pipe(Object(A.a)(void 0),Object(S.a)(),Object(D.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function hp(t,e,n){return cp(t,n).pipe(Object(k.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return lp(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return lp(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return lp(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(N.a)(),Object(D.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function lp(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function fp(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class dp{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=cp(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(D.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(A.a)(void 0),Object(S.a)(),Object(C.a)(([t,e])=>e.length>0||!t),Object(D.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(k.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=fp(t);return hp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return up(this.query,this.afs.schedulers.outsideAngular).pipe(Object(D.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(_.a)(this.query.get(t)).pipe(Object(j.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new pp(this.ref.doc(t),this.afs)}}class pp{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=wp(n,e);return new dp(r,i,this.afs)}snapshotChanges(){return ap(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(A.a)(void 0),Object(S.a)(),Object(D.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(D.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(_.a)(this.ref.get(t)).pipe(Object(j.b)(this.afs.schedulers.insideAngular))}}class gp{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?cp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(D.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(C.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):cp(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(k.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=fp(t);return hp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return up(this.query,this.afs.schedulers.outsideAngular).pipe(Object(D.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(_.a)(this.query.get(t)).pipe(Object(j.b)(this.afs.schedulers.insideAngular))}}const mp=new i.s("angularfire2.enableFirestorePersistence"),yp=new i.s("angularfire2.firestore.persistenceSettings"),bp=new i.s("angularfire2.firestore.settings"),vp=new i.s("angularfire2.firestore.use-emulator");function wp(t,e=(t=>t)){return{query:e(t),ref:t}}let Ep=(()=>{class t{constructor(t,e,n,i,o,s,a,u,c){this.schedulers=new x.d(s),this.keepUnstableUntilFirst=Object(x.h)(this.schedulers);const h=Object(x.g)(t,s,e);!U.a.auth&&c&&Object(x.j)();const l=u;[this.firestore,this.persistenceEnabled$]=Object(x.f)(`${h.name}.firestore`,"AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),l&&t.useEmulator(...l),n&&!Object(r.u)(o)){const e=()=>{try{return Object(_.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(ep){return"undefined"!=typeof console&&console.warn(ep),Object(O.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(O.a)(!1)]},[i,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=wp(n,e),o=this.schedulers.ngZone.run(()=>r);return new dp(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new gp(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new pp(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(x.c),i.Zb(x.b,8),i.Zb(mp,8),i.Zb(bp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(yp,8),i.Zb(vp,8),i.Zb(sp.b,8))},t.\u0275prov=i.Lb({factory:function(){return new t(i.Zb(x.c),i.Zb(x.b,8),i.Zb(mp,8),i.Zb(bp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(yp,8),i.Zb(vp,8),i.Zb(sp.b,8))},token:t,providedIn:"any"}),t})();var Ip=n("kmnG"),Tp=n("qFsG"),_p=n("3Pt+");let Op=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("costumers").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat menyimpan data")})}else this.db.collection("costumers").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat mengupdate data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.g),i.Pb(o.a),i.Pb(Ep),i.Pb(sp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-product-detail"]],decls:36,vars:9,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["matInput","","type","date",3,"ngModel","ngModelChange"],["matInput","","type","number",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"h3",0),i.Ac(1," Reservation\n"),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"mat-form-field",2),i.Vb(4,"mat-label"),i.Ac(5,"NAMA"),i.Ub(),i.Vb(6,"input",3),i.cc("ngModelChange",function(t){return e.data.nama=t}),i.Ub(),i.Ub(),i.Vb(7,"mat-form-field",2),i.Vb(8,"mat-label"),i.Ac(9,"MODEL"),i.Ub(),i.Vb(10,"input",3),i.cc("ngModelChange",function(t){return e.data.model=t}),i.Ub(),i.Ub(),i.Vb(11,"mat-form-field",2),i.Vb(12,"mat-label"),i.Ac(13,"HARI"),i.Ub(),i.Vb(14,"input",3),i.cc("ngModelChange",function(t){return e.data.hari=t}),i.Ub(),i.Ub(),i.Vb(15,"mat-form-field",2),i.Vb(16,"mat-label"),i.Ac(17,"TANGGAL"),i.Ub(),i.Vb(18,"input",4),i.cc("ngModelChange",function(t){return e.data.tanggal=t}),i.Ub(),i.Ub(),i.Vb(19,"mat-form-field",2),i.Vb(20,"mat-label"),i.Ac(21,"STATUS"),i.Ub(),i.Vb(22,"input",3),i.cc("ngModelChange",function(t){return e.data.status=t}),i.Ub(),i.Ub(),i.Vb(23,"mat-form-field",2),i.Vb(24,"mat-label"),i.Ac(25,"BARBER"),i.Ub(),i.Vb(26,"input",3),i.cc("ngModelChange",function(t){return e.data.barber=t}),i.Ub(),i.Ub(),i.Vb(27,"mat-form-field",2),i.Vb(28,"mat-label"),i.Ac(29,"HARGA"),i.Ub(),i.Vb(30,"input",5),i.cc("ngModelChange",function(t){return e.data.harga=t}),i.Ub(),i.Ub(),i.Ub(),i.Vb(31,"div",6),i.Vb(32,"button",7),i.Ac(33,"Batal"),i.Ub(),i.Vb(34,"button",8),i.cc("click",function(){return e.saveData()}),i.Ac(35),i.Ub(),i.Ub()),2&t&&(i.Eb(6),i.lc("ngModel",e.data.nama),i.Eb(4),i.lc("ngModel",e.data.model),i.Eb(4),i.lc("ngModel",e.data.hari),i.Eb(4),i.lc("ngModel",e.data.tanggal),i.Eb(4),i.lc("ngModel",e.data.status),i.Eb(4),i.lc("ngModel",e.data.barber),i.Eb(4),i.lc("ngModel",e.data.harga),i.Eb(4),i.lc("disabled",e.loading),i.Eb(1),i.Bc(e.loading?"Menyimpan..":"Simpan"))},directives:[o.h,o.e,Ip.b,Ip.e,Tp.b,_p.c,_p.i,_p.k,_p.l,o.c,u.a,o.d],styles:[""]}),t})();function Ap(t,e){if(1&t){const t=i.Wb();i.Vb(0,"tr"),i.Vb(1,"td"),i.Ac(2),i.Ub(),i.Vb(3,"td"),i.Ac(4),i.Ub(),i.Vb(5,"td"),i.Ac(6),i.Ub(),i.Vb(7,"td"),i.Ac(8),i.Ub(),i.Vb(9,"td"),i.Ac(10),i.Ub(),i.Vb(11,"td"),i.Ac(12),i.Ub(),i.Vb(13,"td"),i.Ac(14),i.Ub(),i.Vb(15,"td"),i.Ac(16),i.Ub(),i.Vb(17,"td",4),i.Vb(18,"button",6),i.Vb(19,"mat-icon"),i.Ac(20,"question_answer"),i.Ub(),i.Ub(),i.Vb(21,"button",7),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc().productDetail(n,r)}),i.Ac(22,"Edit"),i.Ub(),i.Vb(23,"button",8),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc().deleteProduct(n.id,r)}),i.Ac(24),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=e.$implicit,n=e.index,r=i.gc();i.Eb(2),i.Bc(n+1),i.Eb(2),i.Bc(t.nama),i.Eb(2),i.Bc(t.model),i.Eb(2),i.Bc(t.hari),i.Eb(2),i.Bc(t.tanggal),i.Eb(2),i.Bc(t.status),i.Eb(2),i.Bc(t.barber),i.Eb(2),i.Bc(t.harga),i.Eb(7),i.lc("disabled",r.loadingDelete[n]),i.Eb(1),i.Bc(r.loadingDelete[n]?"Deleting..":"Delete")}}let Sp=(()=>{class t{constructor(t,e,n){this.dialog=t,this.db=e,this.auth=n,this.costumer=[],this.userData={},this.loadingDelete={}}ngOnInit(){this.title="Costumers",this.auth.user.subscribe(t=>{this.userData=t,this.getCostumers()})}getCostumers(){this.loading=!0,this.db.collection("costumers",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.costumers=t,this.loading=!1},t=>{this.loading=!1})}productDetail(t,e){this.dialog.open(Op,{width:"400px",data:t}).afterClosed().subscribe(t=>{t&&(-1==e?this.costumers.push(t):this.costumers[e]=t)})}deleteProduct(t,e){confirm("Delete Item?")&&this.db.collection("costumers").doc(t).delete().then(t=>{this.costumers.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.b),i.Pb(Ep),i.Pb(sp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-product"]],decls:30,vars:2,consts:[[1,"uk-flex"],[1,"uk-width-expand"],["mat-flat-button","","color","primary",3,"click"],[1,"uk-table","uk-table-middle","uk-table-divider"],["align","right"],[4,"ngFor","ngForOf"],["mat-flat-button","","routerLink","/admin/feedback/","color","accent"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"mat-card"),i.Vb(1,"mat-card-header"),i.Vb(2,"mat-card-title"),i.Ac(3),i.Ub(),i.Ub(),i.Vb(4,"mat-card-content"),i.Vb(5,"div",0),i.Qb(6,"span",1),i.Vb(7,"button",2),i.cc("click",function(){return e.productDetail({},-1)}),i.Ac(8,"Reservation"),i.Ub(),i.Ub(),i.Vb(9,"table",3),i.Vb(10,"thead"),i.Vb(11,"th"),i.Ac(12,"No"),i.Ub(),i.Vb(13,"th"),i.Ac(14,"Nama"),i.Ub(),i.Vb(15,"th"),i.Ac(16,"Model"),i.Ub(),i.Vb(17,"th"),i.Ac(18,"Hari"),i.Ub(),i.Vb(19,"th"),i.Ac(20,"Tanggal"),i.Ub(),i.Vb(21,"th"),i.Ac(22,"Status"),i.Ub(),i.Vb(23,"th"),i.Ac(24,"Barber"),i.Ub(),i.Vb(25,"th"),i.Ac(26,"Harga"),i.Ub(),i.Qb(27,"th",4),i.Ub(),i.Vb(28,"tbody"),i.zc(29,Ap,25,10,"tr",5),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&t&&(i.Eb(3),i.Bc(e.title),i.Eb(26),i.lc("ngForOf",e.costumers))},directives:[v.a,v.c,v.e,v.b,u.a,r.j,s.b,c.a],styles:[""]}),t})(),Dp=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("hairs").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat menyimpan data")})}else this.db.collection("hairs").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat mengupdate data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.g),i.Pb(o.a),i.Pb(Ep),i.Pb(sp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-haircare-detail"]],decls:32,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["matInput","","type","number",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"h3",0),i.Ac(1," HairCare\n"),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"mat-form-field",2),i.Vb(4,"mat-label"),i.Ac(5,"NAMA"),i.Ub(),i.Vb(6,"input",3),i.cc("ngModelChange",function(t){return e.data.nama=t}),i.Ub(),i.Ub(),i.Vb(7,"mat-form-field",2),i.Vb(8,"mat-label"),i.Ac(9,"KODE"),i.Ub(),i.Vb(10,"input",3),i.cc("ngModelChange",function(t){return e.data.kode=t}),i.Ub(),i.Ub(),i.Vb(11,"mat-form-field",2),i.Vb(12,"mat-label"),i.Ac(13,"JENIS"),i.Ub(),i.Vb(14,"input",3),i.cc("ngModelChange",function(t){return e.data.jenis=t}),i.Ub(),i.Ub(),i.Vb(15,"mat-form-field",2),i.Vb(16,"mat-label"),i.Ac(17,"JUMLAH"),i.Ub(),i.Vb(18,"input",4),i.cc("ngModelChange",function(t){return e.data.jumlah=t}),i.Ub(),i.Ub(),i.Vb(19,"mat-form-field",2),i.Vb(20,"mat-label"),i.Ac(21,"HARGA"),i.Ub(),i.Vb(22,"input",4),i.cc("ngModelChange",function(t){return e.data.harga=t}),i.Ub(),i.Ub(),i.Vb(23,"mat-form-field",2),i.Vb(24,"mat-label"),i.Ac(25,"DISKON"),i.Ub(),i.Vb(26,"input",4),i.cc("ngModelChange",function(t){return e.data.diskon=t}),i.Ub(),i.Ub(),i.Ub(),i.Vb(27,"div",5),i.Vb(28,"button",6),i.Ac(29,"Batal"),i.Ub(),i.Vb(30,"button",7),i.cc("click",function(){return e.saveData()}),i.Ac(31),i.Ub(),i.Ub()),2&t&&(i.Eb(6),i.lc("ngModel",e.data.nama),i.Eb(4),i.lc("ngModel",e.data.kode),i.Eb(4),i.lc("ngModel",e.data.jenis),i.Eb(4),i.lc("ngModel",e.data.jumlah),i.Eb(4),i.lc("ngModel",e.data.harga),i.Eb(4),i.lc("ngModel",e.data.diskon),i.Eb(4),i.lc("disabled",e.loading),i.Eb(1),i.Bc(e.loading?"Menyimpan..":"Simpan"))},directives:[o.h,o.e,Ip.b,Ip.e,Tp.b,_p.c,_p.i,_p.k,_p.l,o.c,u.a,o.d],styles:[""]}),t})();function kp(t,e){if(1&t){const t=i.Wb();i.Vb(0,"tr"),i.Vb(1,"td"),i.Ac(2),i.Ub(),i.Vb(3,"td"),i.Ac(4),i.Ub(),i.Vb(5,"td"),i.Ac(6),i.Ub(),i.Vb(7,"td"),i.Ac(8),i.Ub(),i.Vb(9,"td"),i.Ac(10),i.Ub(),i.Vb(11,"td"),i.Ac(12),i.Ub(),i.Vb(13,"td"),i.Ac(14),i.Ub(),i.Vb(15,"td",3),i.Vb(16,"button",5),i.Vb(17,"mat-icon"),i.Ac(18,"add_shopping_cart"),i.Ub(),i.Ub(),i.Vb(19,"button",6),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc().haircareDetail(n,r)}),i.Ac(20,"Edit"),i.Ub(),i.Vb(21,"button",7),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc().deleteHairCare(n.id,r)}),i.Ac(22),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=e.$implicit,n=e.index,r=i.gc();i.Eb(2),i.Bc(n+1),i.Eb(2),i.Bc(t.nama),i.Eb(2),i.Bc(t.kode),i.Eb(2),i.Bc(t.jenis),i.Eb(2),i.Bc(t.jumlah),i.Eb(2),i.Bc(t.harga),i.Eb(2),i.Bc(t.diskon),i.Eb(7),i.lc("disabled",r.loadingDelete[n]),i.Eb(1),i.Bc(r.loadingDelete[n]?"Deleting..":"Delete")}}let Np=(()=>{class t{constructor(t,e,n){this.dialog=t,this.db=e,this.auth=n,this.hair=[],this.userData={},this.loadingDelete={}}ngOnInit(){this.title="HairCare",this.auth.user.subscribe(t=>{this.userData=t,this.getHairs()})}getHairs(){this.loading=!0,this.db.collection("hairs",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.hairs=t,this.loading=!1},t=>{this.loading=!1})}haircareDetail(t,e){this.dialog.open(Dp,{width:"400px",data:t}).afterClosed().subscribe(t=>{t&&(-1==e?this.hairs.push(t):this.hairs[e]=t)})}deleteHairCare(t,e){confirm("Delete Item?")&&this.db.collection("hairs").doc(t).delete().then(t=>{this.hairs.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.b),i.Pb(Ep),i.Pb(sp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-haircare"]],decls:27,vars:2,consts:[[1,"uk-flex","uk-flex-right"],["mat-flat-button","","color","primary",3,"click"],[1,"uk-table","uk-table-middle","uk-table-divider"],["align","right"],[4,"ngFor","ngForOf"],["mat-flat-button","","routerLink","/admin/keranjang/","color","accent"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"mat-card"),i.Vb(1,"mat-card-header"),i.Vb(2,"mat-card-title"),i.Ac(3),i.Ub(),i.Ub(),i.Vb(4,"mat-card-content"),i.Vb(5,"div",0),i.Vb(6,"button",1),i.cc("click",function(){return e.haircareDetail({},-1)}),i.Ac(7,"HairCare"),i.Ub(),i.Ub(),i.Vb(8,"table",2),i.Vb(9,"thead"),i.Vb(10,"th"),i.Ac(11,"No"),i.Ub(),i.Vb(12,"th"),i.Ac(13,"Nama"),i.Ub(),i.Vb(14,"th"),i.Ac(15,"kode"),i.Ub(),i.Vb(16,"th"),i.Ac(17,"jenis"),i.Ub(),i.Vb(18,"th"),i.Ac(19,"jumlah"),i.Ub(),i.Vb(20,"th"),i.Ac(21,"Harga"),i.Ub(),i.Vb(22,"th"),i.Ac(23,"Diskon"),i.Ub(),i.Qb(24,"th",3),i.Ub(),i.Vb(25,"tbody"),i.zc(26,kp,23,9,"tr",4),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&t&&(i.Eb(3),i.Bc(e.title),i.Eb(23),i.lc("ngForOf",e.hairs))},directives:[v.a,v.c,v.e,v.b,u.a,r.j,s.b,c.a],styles:[""]}),t})(),Cp=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}onFileChange(t){t.target.files.length>0&&(this.selectedFile=t.target.files[0],"file/image"!=this.selectedFile.type&&alert("file harus berbentu image"),console.log(this.selectedFile))}uploadFile(){if((new FormData).append("file",this.selectedFile),this.loadingUpload=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("feedbacks").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loadingUpload=!1}).catch(t=>{console.log(t),this.loadingUpload=!1,alert("Tidak dapat menyimpan data")})}else this.db.collection("feedbacks").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loadingUpload=!1}).catch(t=>{console.log(t),this.loadingUpload=!1,alert("Tidak dapat mengupdate data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.g),i.Pb(o.a),i.Pb(Ep),i.Pb(sp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-file-uploader"]],decls:13,vars:4,consts:[[1,"uk-flex","uk-flex-middle","uk-flex-center",2,"height","100px","outline","2px dashed #ccc","margin","10px",3,"click"],["type","file","id","file",2,"display","none",3,"ngModel","change","ngModelChange"],["fileInput",""],[1,"uk-flex","uk-flex-right"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","accent",3,"disabled","click"]],template:function(t,e){if(1&t){const t=i.Wb();i.Vb(0,"mat-card-header"),i.Vb(1,"mat-card-title"),i.Ac(2,"Add Image"),i.Ub(),i.Ub(),i.Vb(3,"div",0),i.cc("click",function(){return i.tc(t),i.rc(7).click()}),i.Vb(4,"span"),i.Ac(5),i.Ub(),i.Vb(6,"input",1,2),i.cc("change",function(t){return e.onFileChange(t)})("ngModelChange",function(t){return e.data.file=t}),i.Ub(),i.Ub(),i.Vb(8,"div",3),i.Vb(9,"button",4),i.Ac(10,"Cancel"),i.Ub(),i.Vb(11,"button",5),i.cc("click",function(){return e.uploadFile()}),i.Ac(12),i.Ub(),i.Ub()}2&t&&(i.Eb(5),i.Bc(e.selectedFile?e.selectedFile.name:"Masukan Gambar"),i.Eb(1),i.lc("ngModel",e.data.file),i.Eb(5),i.lc("disabled",e.loadingUpload),i.Eb(1),i.Bc(e.loadingUpload?"Uploading":"Upload"))},directives:[v.c,v.e,_p.c,_p.i,_p.k,u.a,o.d],styles:[""]}),t})(),jp=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("feedbacks").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat menyimpan data")})}else this.db.collection("feedbacks").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat mengupdate data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.g),i.Pb(o.a),i.Pb(Ep),i.Pb(sp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-feedback-detail"]],decls:32,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["matInput","","type","date",3,"ngModel","ngModelChange"],["matInput","","matInput","","type","number",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"h3",0),i.Ac(1," Review\n"),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"mat-form-field",2),i.Vb(4,"mat-label"),i.Ac(5,"NAMA"),i.Ub(),i.Vb(6,"input",3),i.cc("ngModelChange",function(t){return e.data.nama=t}),i.Ub(),i.Ub(),i.Vb(7,"mat-form-field",2),i.Vb(8,"mat-label"),i.Ac(9,"HARI"),i.Ub(),i.Vb(10,"input",3),i.cc("ngModelChange",function(t){return e.data.hari=t}),i.Ub(),i.Ub(),i.Vb(11,"mat-form-field",2),i.Vb(12,"mat-label"),i.Ac(13,"TANGGAL"),i.Ub(),i.Vb(14,"input",4),i.cc("ngModelChange",function(t){return e.data.tanggal=t}),i.Ub(),i.Ub(),i.Vb(15,"mat-form-field",2),i.Vb(16,"mat-label"),i.Ac(17,"BARBER"),i.Ub(),i.Vb(18,"input",3),i.cc("ngModelChange",function(t){return e.data.barber=t}),i.Ub(),i.Ub(),i.Vb(19,"mat-form-field",2),i.Vb(20,"mat-label"),i.Ac(21,"RATING"),i.Ub(),i.Vb(22,"input",5),i.cc("ngModelChange",function(t){return e.data.rating=t}),i.Ub(),i.Ub(),i.Vb(23,"mat-form-field",2),i.Vb(24,"mat-label"),i.Ac(25,"KOMENTAR"),i.Ub(),i.Vb(26,"input",3),i.cc("ngModelChange",function(t){return e.data.komentar=t}),i.Ub(),i.Ub(),i.Ub(),i.Vb(27,"div",6),i.Vb(28,"button",7),i.Ac(29,"Batal"),i.Ub(),i.Vb(30,"button",8),i.cc("click",function(){return e.saveData()}),i.Ac(31),i.Ub(),i.Ub()),2&t&&(i.Eb(6),i.lc("ngModel",e.data.nama),i.Eb(4),i.lc("ngModel",e.data.hari),i.Eb(4),i.lc("ngModel",e.data.tanggal),i.Eb(4),i.lc("ngModel",e.data.barber),i.Eb(4),i.lc("ngModel",e.data.rating),i.Eb(4),i.lc("ngModel",e.data.komentar),i.Eb(4),i.lc("disabled",e.loading),i.Eb(1),i.Bc(e.loading?"Menyimpan..":"Simpan"))},directives:[o.h,o.e,Ip.b,Ip.e,Tp.b,_p.c,_p.i,_p.k,_p.l,o.c,u.a,o.d],styles:[""]}),t})();function xp(t,e){if(1&t){const t=i.Wb();i.Vb(0,"tr"),i.Vb(1,"td"),i.Ac(2),i.Ub(),i.Vb(3,"td"),i.Ac(4),i.Ub(),i.Vb(5,"td"),i.Ac(6),i.Ub(),i.Vb(7,"td"),i.Ac(8),i.Ub(),i.Vb(9,"td"),i.Ac(10),i.Ub(),i.Vb(11,"td"),i.Ac(12),i.Ub(),i.Vb(13,"td"),i.Ac(14),i.Ub(),i.Vb(15,"td"),i.Ac(16),i.Ub(),i.Vb(17,"td",4),i.Vb(18,"button",6),i.cc("click",function(){i.tc(t);const n=e.$implicit;return i.gc().uploadFile(n)}),i.Ac(19,"Upload"),i.Ub(),i.Vb(20,"button",6),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc().feedbackDetail(n,r)}),i.Ac(21,"Edit"),i.Ub(),i.Vb(22,"button",7),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc().deletefeedback(n.id,r)}),i.Ac(23),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=e.$implicit,n=e.index,r=i.gc();i.Eb(2),i.Bc(n+1),i.Eb(2),i.Bc(t.nama),i.Eb(2),i.Bc(t.hari),i.Eb(2),i.Bc(t.tanggal),i.Eb(2),i.Bc(t.barber),i.Eb(2),i.Bc(t.rating),i.Eb(2),i.Bc(t.komentar),i.Eb(2),i.Bc(t.file),i.Eb(6),i.lc("disabled",r.loadingDelete[n]),i.Eb(1),i.Bc(r.loadingDelete[n]?"Deleting..":"Delete")}}let Up=(()=>{class t{constructor(t,e,n){this.dialog=t,this.db=e,this.auth=n,this.feedback=[],this.userData={},this.loadingDelete={}}ngOnInit(){this.title="Review",this.auth.user.subscribe(t=>{this.userData=t,this.getFeedbacks()})}getFeedbacks(){this.loading=!0,this.db.collection("feedbacks",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.feedbacks=t,this.loading=!1},t=>{this.loading=!1})}feedbackDetail(t,e){this.dialog.open(jp,{width:"400px",data:t}).afterClosed().subscribe(t=>{t&&(-1==e?this.feedbacks.push(t):this.feedbacks[e]=t)})}deletefeedback(t,e){confirm("Delete Item?")&&this.db.collection("feedbacks").doc(t).delete().then(t=>{this.feedbacks.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}uploadFile(t){this.dialog.open(Cp,{width:"400px",data:t}).afterClosed().subscribe(t=>{})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.b),i.Pb(Ep),i.Pb(sp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-feedback"]],decls:30,vars:2,consts:[[1,"uk-flex"],[1,"uk-width-expand"],["mat-flat-button","","color","primary",3,"click"],[1,"uk-table","uk-table-middle","uk-table-divider"],["align","right"],[4,"ngFor","ngForOf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"mat-card"),i.Vb(1,"mat-card-header"),i.Vb(2,"mat-card-title"),i.Ac(3),i.Ub(),i.Ub(),i.Vb(4,"mat-card-content"),i.Vb(5,"div",0),i.Qb(6,"span",1),i.Vb(7,"button",2),i.cc("click",function(){return e.feedbackDetail({},-1)}),i.Ac(8,"Penilaian"),i.Ub(),i.Ub(),i.Vb(9,"table",3),i.Vb(10,"thead"),i.Vb(11,"th"),i.Ac(12,"No"),i.Ub(),i.Vb(13,"th"),i.Ac(14,"Nama"),i.Ub(),i.Vb(15,"th"),i.Ac(16,"hari"),i.Ub(),i.Vb(17,"th"),i.Ac(18,"Tanggal"),i.Ub(),i.Vb(19,"th"),i.Ac(20,"Barber"),i.Ub(),i.Vb(21,"th"),i.Ac(22,"Rating"),i.Ub(),i.Vb(23,"th"),i.Ac(24,"Komentar"),i.Ub(),i.Vb(25,"th"),i.Ac(26,"Add Images"),i.Ub(),i.Qb(27,"th",4),i.Ub(),i.Vb(28,"tbody"),i.zc(29,xp,24,10,"tr",5),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&t&&(i.Eb(3),i.Bc(e.title),i.Eb(26),i.lc("ngForOf",e.feedbacks))},directives:[v.a,v.c,v.e,v.b,u.a,r.j],styles:[""]}),t})(),Vp=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("trollys").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat menyimpan data")})}else this.db.collection("trollys").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat mengupdate data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.g),i.Pb(o.a),i.Pb(Ep),i.Pb(sp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-keranjang-detail"]],decls:32,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["matInput","","type","number",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"h3",0),i.Ac(1," Trolly\n"),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"mat-form-field",2),i.Vb(4,"mat-label"),i.Ac(5,"NAMA"),i.Ub(),i.Vb(6,"input",3),i.cc("ngModelChange",function(t){return e.data.nama=t}),i.Ub(),i.Ub(),i.Vb(7,"mat-form-field",2),i.Vb(8,"mat-label"),i.Ac(9,"KODE"),i.Ub(),i.Vb(10,"input",3),i.cc("ngModelChange",function(t){return e.data.kode=t}),i.Ub(),i.Ub(),i.Vb(11,"mat-form-field",2),i.Vb(12,"mat-label"),i.Ac(13,"JENIS"),i.Ub(),i.Vb(14,"input",3),i.cc("ngModelChange",function(t){return e.data.jenis=t}),i.Ub(),i.Ub(),i.Vb(15,"mat-form-field",2),i.Vb(16,"mat-label"),i.Ac(17,"JUMLAH"),i.Ub(),i.Vb(18,"input",4),i.cc("ngModelChange",function(t){return e.data.jumlah=t}),i.Ub(),i.Ub(),i.Vb(19,"mat-form-field",2),i.Vb(20,"mat-label"),i.Ac(21,"HARGA"),i.Ub(),i.Vb(22,"input",4),i.cc("ngModelChange",function(t){return e.data.harga=t}),i.Ub(),i.Ub(),i.Vb(23,"mat-form-field",2),i.Vb(24,"mat-label"),i.Ac(25,"PEMBAYARAN"),i.Ub(),i.Vb(26,"input",3),i.cc("ngModelChange",function(t){return e.data.pembayaran=t}),i.Ub(),i.Ub(),i.Ub(),i.Vb(27,"div",5),i.Vb(28,"button",6),i.Ac(29,"Batal"),i.Ub(),i.Vb(30,"button",7),i.cc("click",function(){return e.saveData()}),i.Ac(31),i.Ub(),i.Ub()),2&t&&(i.Eb(6),i.lc("ngModel",e.data.nama),i.Eb(4),i.lc("ngModel",e.data.kode),i.Eb(4),i.lc("ngModel",e.data.jenis),i.Eb(4),i.lc("ngModel",e.data.jumlah),i.Eb(4),i.lc("ngModel",e.data.harga),i.Eb(4),i.lc("ngModel",e.data.pembayaran),i.Eb(4),i.lc("disabled",e.loading),i.Eb(1),i.Bc(e.loading?"Menyimpan..":"Simpan"))},directives:[o.h,o.e,Ip.b,Ip.e,Tp.b,_p.c,_p.i,_p.k,_p.l,o.c,u.a,o.d],styles:[""]}),t})();function Rp(t,e){if(1&t){const t=i.Wb();i.Vb(0,"tr"),i.Vb(1,"td"),i.Ac(2),i.Ub(),i.Vb(3,"td"),i.Ac(4),i.Ub(),i.Vb(5,"td"),i.Ac(6),i.Ub(),i.Vb(7,"td"),i.Ac(8),i.Ub(),i.Vb(9,"td"),i.Ac(10),i.Ub(),i.Vb(11,"td"),i.Ac(12),i.Ub(),i.Vb(13,"td"),i.Ac(14),i.Ub(),i.Vb(15,"td",5),i.Vb(16,"button",7),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc().keranjangDetail(n,r)}),i.Ac(17,"Edit"),i.Ub(),i.Vb(18,"button",8),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc().deleteKeranjang(n.id,r)}),i.Ac(19),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=e.$implicit,n=e.index,r=i.gc();i.Eb(2),i.Bc(n+1),i.Eb(2),i.Bc(t.nama),i.Eb(2),i.Bc(t.kode),i.Eb(2),i.Bc(t.jenis),i.Eb(2),i.Bc(t.jumlah),i.Eb(2),i.Bc(t.harga),i.Eb(2),i.Bc(t.pembayaran),i.Eb(4),i.lc("disabled",r.loadingDelete[n]),i.Eb(1),i.Bc(r.loadingDelete[n]?"Deleting..":"Delete")}}const Mp=[{path:"",component:b,children:[{path:"dashboard",component:w},{path:"product",component:Sp},{path:"haircare",component:Np},{path:"keranjang",component:(()=>{class t{constructor(t,e,n){this.dialog=t,this.db=e,this.auth=n,this.trolly=[],this.userData={},this.loadingDelete={}}ngOnInit(){this.title="Trolly",this.auth.user.subscribe(t=>{this.userData=t,this.getTrollys()})}getTrollys(){this.loading=!0,this.db.collection("trollys",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.trollys=t,this.loading=!1},t=>{this.loading=!1})}keranjangDetail(t,e){this.dialog.open(Vp,{width:"400px",data:t}).afterClosed().subscribe(t=>{t&&(-1==e?this.trollys.push(t):this.trollys[e]=t)})}deleteKeranjang(t,e){confirm("Delete Item?")&&this.db.collection("trollys").doc(t).delete().then(t=>{this.trollys.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.b),i.Pb(Ep),i.Pb(sp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-keranjang"]],decls:30,vars:2,consts:[[1,"uk-flex","uk-flex-right"],["mat-flat-button","","color","primary","routerLink","/admin/haircare/"],[1,"uk-flex","uk-flex-left"],["mat-flat-button","","color","primary",3,"click"],[1,"uk-table","uk-table-middle","uk-table-divider"],["align","right"],[4,"ngFor","ngForOf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"mat-card"),i.Vb(1,"mat-card-header"),i.Vb(2,"mat-card-title"),i.Ac(3),i.Ub(),i.Ub(),i.Vb(4,"mat-card-content"),i.Vb(5,"div",0),i.Vb(6,"button",1),i.Ac(7,"Tambah Produk"),i.Ub(),i.Ub(),i.Vb(8,"div",2),i.Vb(9,"button",3),i.cc("click",function(){return e.keranjangDetail({},-1)}),i.Ac(10,"ISI"),i.Ub(),i.Ub(),i.Vb(11,"table",4),i.Vb(12,"thead"),i.Vb(13,"th"),i.Ac(14,"No"),i.Ub(),i.Vb(15,"th"),i.Ac(16,"Nama"),i.Ub(),i.Vb(17,"th"),i.Ac(18,"kode"),i.Ub(),i.Vb(19,"th"),i.Ac(20,"jenis"),i.Ub(),i.Vb(21,"th"),i.Ac(22,"jumlah"),i.Ub(),i.Vb(23,"th"),i.Ac(24,"Harga"),i.Ub(),i.Vb(25,"th"),i.Ac(26,"Pembayaran"),i.Ub(),i.Qb(27,"th",5),i.Ub(),i.Vb(28,"tbody"),i.zc(29,Rp,20,9,"tr",6),i.Ub(),i.Ub(),i.Ub(),i.Ub()),2&t&&(i.Eb(3),i.Bc(e.title),i.Eb(26),i.lc("ngForOf",e.trollys))},directives:[v.a,v.c,v.e,v.b,u.a,s.b,r.j],styles:[""]}),t})()},{path:"feedback",component:Up},{path:"",pathMatch:"full",redirectTo:"/admin/dashboard"}]}];let Pp=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Nb({type:t}),t.\u0275inj=i.Mb({imports:[[r.c,s.c.forChild(Mp),E.a,_p.e]]}),t})()}}]);